---
title: "Javelins with hyper3 objects"
author: "R. K. S. Hankin"
output: bookdown::html_document2
bibliography: hyper2.bib
---

```{r setup, include=FALSE}
set.seed(1)
knitr::opts_chunk$set(echo = TRUE)
library("hyper2")
library("disordR")
```

```{r out.width='20%', out.extra='style="float:right; padding:10px"',echo=FALSE}
knitr::include_graphics(system.file("help/figures/hyper2.png", package = "hyper2"))
```

To cite the `hyper2` package in publications, please use @hankin2017_rmd.
Here we analyse results from the men's javelin, 2020 Summer Olympics.

```{r, label=loadjavelinandconvert}
javelin_table <- as.attemptstable(read.table("javelin.txt", header=TRUE))
a <- javelin_table # saves typing
javelin_table
```

Above, we see that Chopra threw 87.03 on his first throw, 87.58 on his
second, and so on (all measurements are in meters).  Vadlejch threw
83.98 on his first throw, etc.  We may convert this to a named vector
with elements being the throw distances, and names being the
competitors:


```{r, label=converttosupp3, cache=TRUE}
javelin_vector <- as.vector(javelin_table)
javelin_vector
o <- javelin_vector # saves typing
```

Above we see that Chopra threw the longest and second-longest throws
of 87.58 and 87.03 respectively;
Vadlejch threw the third-longest throw of 86.67, and so on.  `NA`
entries correspond to no-throws.  It is easy to plot the data in
visual form:

```{r, label=plotjav}
n <- length(levels(as.factor(names(o))))
plot(o, pch=16, col=rainbow(n)[as.factor(names(o))])
legend("topright", pch=16, col=rainbow(n), legend=levels(as.factor(names(o))))
```

Now convert the attempts table to a `hyper3` object, using function
\code{suppfun()}.  However, note that there are two reasonable
interpretations: firstly, we simply ignore no-throws [in the package
docs, these are sometimes referred to as "DNF", or "Did not finish",
following Formula 1 terminology] and to do this we pass
`dnf.last=FALSE`:

```{r, label=dothething2, cache=TRUE}
javelin1 <- suppfun(javelin_table, dnf.last=FALSE)
H1 <- javelin1 # saves typing
javelin1_maxp  <- maxp(H1)
m1 <- javelin1_maxp
```

Secondly, we may treat no-throws as being inferior to any actual
measured throw.  We specify `dnf.last=TRUE`:

```{r,label=dothething1,cache=TRUE}    	   
javelin2 <- suppfun(javelin_table, dnf.last=TRUE)
H2 <- javelin2 # saves typing
javelin2_maxp <- maxp(H2)
m2 <- javelin2_maxp
```

Investigation:

```{r, label=plotm}
rbind(one=m1, two=m2)
pie(m1)
pie(m2)
dotchart(m1, pch=16)
dotchart(m2, pch=16)
ordertransplot(m1, m2)
```

```{r, dothetests, cache=TRUE}
equalp.test(javelin1)
equalp.test(javelin2)
```

# Discussion: maximum throw vs Bradley-Terry philosophy

The competition is won by the player who has the longest throw: the
sufficient statistic would be the maximum of the six attempts.
Bradley-Terry cannot handle this if different players have different
variance: short throws are disregarded.

As an example, suppose two throwers have normally distributed
distances; thrower A has a smaller mean distance than thrower B but a
larger variance.  Numerically:

```{r}
set.seed(0)
thrower_A <- round(rnorm(6, 80.2, 2.6), 2)
thrower_B <- round(rnorm(6, 80.3, 1.3), 2)
D <- as.attemptstable(as.data.frame(rbind(thrower_A, thrower_B)))
D
apply(D, 1, max)
```

Above we see that thrower A wins, despite having a smaller mean
distance.


### Package dataset {-}

Following lines create `javelin.rda`, residing in the `data/`
directory of the package.

```{r,label=savejavelindataset}
save(javelin1, javelin2, javelin_table, javelin_vector, javelin1_maxp, javelin2_maxp, file="javelin.rda")
```


## References {-}

`https://en.wikipedia.org/w/index.php?title=Athletics_at_the_2020_Summer_Olympics_%E2%80%93_Men%27s_javelin_throw&oldid=1051014985`

