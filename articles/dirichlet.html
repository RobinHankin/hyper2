<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The `dirichlet()` function in the `hyper2` package • hyper2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The `dirichlet()` function in the `hyper2` package">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hyper2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/dirichlet.html">The `dirichlet()` function in the `hyper2` package</a>
    </li>
    <li>
      <a href="../articles/hyper3_creation.html">Creating `hyper3` objects in the `hyper2` package</a>
    </li>
    <li>
      <a href="../articles/hyper3.html">Generalized Plackett-Luce Likelihoods</a>
    </li>
    <li>
      <a href="../articles/icons.html">Public perception of climate change: the `icons` dataset in the `hyper2` package</a>
    </li>
    <li>
      <a href="../articles/ordertrans.html">The `ordertrans()` function in the `hyper2` package</a>
    </li>
    <li>
      <a href="../articles/zeropower.html">The zero-sum-power issue in the `hyper2` package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/RobinHankin/hyper2/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The <code>dirichlet()</code> function in the
<code>hyper2</code> package</h1>
                        <h4 data-toc-skip class="author">Robin K. S.
Hankin</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RobinHankin/hyper2/blob/master/vignettes/dirichlet.Rmd" class="external-link"><code>vignettes/dirichlet.Rmd</code></a></small>
      <div class="hidden name"><code>dirichlet.Rmd</code></div>

    </div>

    
    
<p><img src="..%2F..%2F..%2F_temp%2FLibrary%2Fhyper2%2Fhelp%2Ffigures%2Fhyper2.png" width="20%" style="float:right; padding:10px"></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dirichlet</span></span></code></pre></div>
<pre><code><span><span class="kw">function</span> <span class="op">(</span><span class="va">powers</span>, <span class="va">alpha</span><span class="op">)</span> </span>
<span><span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">xor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">powers</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"supply exactly one of powers, alpha"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">powers</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">powers</span> <span class="op">&lt;-</span> <span class="va">alpha</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">np</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">powers</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">np</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"supply a named vector"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="../reference/hyper2.html">hyper2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">np</span><span class="op">)</span>, d <span class="op">=</span> <span class="va">powers</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="../reference/hyper2.html">hyper2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">np</span><span class="op">)</span>, d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">powers</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
<p>To cite the <code>hyper2</code> package in publications, please use
<span class="citation">Hankin (2017)</span>. We say that non-negative
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>p</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">p_1,\ldots, p_n</annotation></semantics></math>
satisfying
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo><msub><mi>p</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum p_i=1</annotation></semantics></math>
follow a <em>Dirichlet distribution</em>, and write
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒟</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>p</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{D}(p_1,\ldots,p_n)</annotation></semantics></math>,
if their density function is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>1</mn></msub><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>α</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>⋯</mi><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>p</mi><mi>i</mi><mrow><msub><mi>α</mi><mi>i</mi></msub><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">\begin{equation}
\frac{\Gamma(\alpha_1+\cdots +\alpha_n)}{\Gamma(\alpha_1)\cdots\Gamma(\alpha_n)}
\prod_{i=1}^n p_i^{\alpha_i-1}
\end{equation}</annotation></semantics></math></p>
<p>for some parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>i</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha_i&gt;0</annotation></semantics></math>.
It is interesting in the current context because it is conjugate to the
multinomial distribution; specifically, given a Dirichlet prior
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒟</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>α</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{D}(\alpha_1,\ldots,\alpha_n)</annotation></semantics></math>
and likelihood function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℒ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>p</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∝</mo><msubsup><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mi>p</mi><mi>i</mi><msub><mi>α</mi><mi>i</mi></msub></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}(p_1,\ldots,p_n)\propto\prod_{i=1}^n p_i^{\alpha_i}</annotation></semantics></math>
then the posterior is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒟</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>α</mi><mi>n</mi></msub><mo>+</mo><msub><mi>a</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{D}(\alpha_1+a_1,\ldots,\alpha_n+a_n)</annotation></semantics></math>.</p>
<p>In the context of the <code>hyper2</code> package, function
<code><a href="../reference/dirichlet.html">dirichlet()</a></code> presents some peculiarities, discussed
here.</p>
<div class="section level2">
<h2 id="a-simple-example">A simple example<a class="anchor" aria-label="anchor" href="#a-simple-example"></a>
</h2>
<p>Consider a three-way trial between players <code>a</code>,
<code>b</code>, and <code>c</code> with eponymous Bradley-Terry
strengths. Suppose that, out of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>+</mo><mn>5</mn><mo>+</mo><mn>3</mn><mo>=</mo><mn>12</mn></mrow><annotation encoding="application/x-tex">4+5+3=12</annotation></semantics></math>
trials, <code>a</code> wins 4, <code>b</code> wins 5, and <code>c</code>
wins 3. Then an appropriate likelihood function would be:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dirichlet.html">dirichlet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">4</span>,b<span class="op">=</span><span class="fl">5</span>,c<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## log(a^4 * (a + b + c)^-12 * b^5 * c^3)</span></span></code></pre>
<p>Note the <code>(a+b+c)^-11</code> term, which is not strictly
necessary according the Dirichlet density function above which has no
such term. However, we see that the returned likelihood function is
<span class="math inline">${\propto}
p_{a\vphantom{abc}}^4p_{b\vphantom{abc}}^5p_{c\vphantom{abc}}^3$</span>
(because
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>a</mi></msub><mo>+</mo><msub><mi>p</mi><mi>b</mi></msub><mo>+</mo><msub><mi>p</mi><mi>c</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p_a+p_b+p_c=1</annotation></semantics></math>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">L1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dirichlet.html">dirichlet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">4</span>,b<span class="op">=</span><span class="fl">5</span>,c<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## log(a^4 * (a + b + c)^-12 * b^5 * c^3)</span></span></code></pre>
<p>Now suppose we observe three-way trials between <code>b</code>,
<code>c</code>, and <code>d</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">L2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dirichlet.html">dirichlet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>b<span class="op">=</span><span class="fl">1</span>,c<span class="op">=</span><span class="fl">1</span>,d<span class="op">=</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## log( b * (b + c + d)^-10 * c * d^8)</span></span></code></pre>
<p>The overall likelihood function would be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub><mo>+</mo><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_1+L_2</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L1</span><span class="op">+</span><span class="va">L2</span></span></code></pre></div>
<pre><code><span><span class="co">## log(a^4 * (a + b + c)^-12 * b^6 * (b + c + d)^-10 * c^4 * d^8)</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/maxp.html">maxp</a></span><span class="op">(</span><span class="va">L1</span><span class="op">+</span><span class="va">L2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          a          b          c          d </span></span>
<span><span class="co">## 0.09090991 0.10909114 0.07272658 0.72727237</span></span></code></pre>
<p>Observe the dominance of competitor <code>d</code>, reasonable on the
grounds that <code>d</code> won 8 of the 10 trials against
<code>b</code> and <code>c</code>; and <code>a</code>, <code>b</code>,
<code>c</code> are more or less evenly matched [chi square test,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.94</mn></mrow><annotation encoding="application/x-tex">p=0.94</annotation></semantics></math>].
Observe further that we can include four-way observations easily:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">L3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dirichlet.html">dirichlet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">4</span>,b<span class="op">=</span><span class="fl">3</span>,c<span class="op">=</span><span class="fl">2</span>,d<span class="op">=</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## log(a^4 * (a + b + c + d)^-15 * b^3 * c^2 * d^6)</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L1</span><span class="op">+</span><span class="va">L2</span><span class="op">+</span><span class="va">L3</span></span></code></pre></div>
<pre><code><span><span class="co">## log(a^8 * (a + b + c)^-12 * (a + b + c + d)^-15 * b^9 * (b + c + d)^-10</span></span>
<span><span class="co">## * c^6 * d^14)</span></span></code></pre>
<p>Package idiom <code>L1+L2+L3</code> operates as expected because
<code><a href="../reference/dirichlet.html">dirichlet()</a></code> includes the denominator. Sometimes we see
situations in which a competitor does not win any trials. Consider the
following:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">L4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dirichlet.html">dirichlet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">5</span>,b<span class="op">=</span><span class="fl">3</span>,c<span class="op">=</span><span class="fl">0</span>,d<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## log(a^5 * (a + b + c + d)^-11 * b^3 * d^3)</span></span></code></pre>
<p>Above, we see that <code>c</code> won no trials and is not present in
the numerator of the expression. However, <code>L4</code> is informative
about competitor <code>c</code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/maxp.html">maxp</a></span><span class="op">(</span><span class="va">L4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##            a            b            c            d </span></span>
<span><span class="co">## 4.546526e-01 2.727224e-01 1.020077e-06 2.726240e-01</span></span></code></pre>
<p>We see that the maximum likelihood estimate for <code>c</code> is
zero (to within numerical tolerance). Further, we may reject the
hypothesis that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>c</mi></msub><mo>=</mo><mfrac><mn>1</mn><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">p_c=\frac{1}{4}</annotation></semantics></math>
[which might be a reasonable consequence of the assumption that all four
competitors have the same strength]:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tests.html">specificp.test</a></span><span class="op">(</span><span class="va">L4</span>,<span class="st">'c'</span>,<span class="fl">0.25</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Constrained support maximization</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  H</span></span>
<span><span class="co">## null hypothesis: sum p_i=1, c = 0.25</span></span>
<span><span class="co">## null estimate:</span></span>
<span><span class="co">##         a         b         c         d </span></span>
<span><span class="co">## 0.3122093 0.2162741 0.2500000 0.2215167 </span></span>
<span><span class="co">## (argmax, constrained optimization)</span></span>
<span><span class="co">## Support for null:  -14.93581 + K</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## alternative hypothesis:  sum p_i=1 </span></span>
<span><span class="co">## alternative estimate:</span></span>
<span><span class="co">##            a            b            c            d </span></span>
<span><span class="co">## 4.546526e-01 2.727224e-01 1.020077e-06 2.726240e-01 </span></span>
<span><span class="co">## (argmax, free optimization)</span></span>
<span><span class="co">## Support for alternative:  -11.738 + K</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## degrees of freedom: 1</span></span>
<span><span class="co">## support difference = 3.197811</span></span>
<span><span class="co">## p-value: 0.01144022 (two sided)</span></span></code></pre>
<p>However, observe that we cannot reject the equality hypothesis, that
is,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>a</mi></msub><mo>=</mo><msub><mi>p</mi><mi>b</mi></msub><mo>=</mo><msub><mi>p</mi><mi>c</mi></msub><mo>=</mo><msub><mi>p</mi><mi>d</mi></msub><mo>=</mo><mfrac><mn>1</mn><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">p_a=p_b=p_c=p_d=\frac{1}{4}</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tests.html">equalp.test</a></span><span class="op">(</span><span class="va">L4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Constrained support maximization</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  L4</span></span>
<span><span class="co">## null hypothesis: a = b = c = d</span></span>
<span><span class="co">## null estimate:</span></span>
<span><span class="co">##    a    b    c    d </span></span>
<span><span class="co">## 0.25 0.25 0.25 0.25 </span></span>
<span><span class="co">## (argmax, constrained optimization)</span></span>
<span><span class="co">## Support for null:  -15.24924 + K</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## alternative hypothesis:  sum p_i=1 </span></span>
<span><span class="co">## alternative estimate:</span></span>
<span><span class="co">##            a            b            c            d </span></span>
<span><span class="co">## 4.546526e-01 2.727224e-01 1.020077e-06 2.726240e-01 </span></span>
<span><span class="co">## (argmax, free optimization)</span></span>
<span><span class="co">## Support for alternative:  -11.738 + K</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## degrees of freedom: 3</span></span>
<span><span class="co">## support difference = 3.511242</span></span>
<span><span class="co">## p-value: 0.07118459</span></span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-hankin2017_rmd" class="csl-entry">
Hankin, R. K. S. 2017. <span>“Partial Rank Data with the
<span><code>hyper2</code></span> Package: Likelihood Functions for
Generalized <span>B</span>radley-<span>T</span>erry Models.”</span>
<em>The R Journal</em> 9 (2): 429–39.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Robin K. S. Hankin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
