<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generalized Plackett-Luce Likelihoods • hyper2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Generalized Plackett-Luce Likelihoods">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hyper2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/dirichlet.html">The `dirichlet()` function in the `hyper2` package</a>
    </li>
    <li>
      <a href="../articles/hyper3_creation.html">Creating `hyper3` objects in the `hyper2` package</a>
    </li>
    <li>
      <a href="../articles/hyper3.html">Generalized Plackett-Luce Likelihoods</a>
    </li>
    <li>
      <a href="../articles/icons.html">Public perception of climate change: the `icons` dataset in the `hyper2` package</a>
    </li>
    <li>
      <a href="../articles/ordertrans.html">The `ordertrans()` function in the `hyper2` package</a>
    </li>
    <li>
      <a href="../articles/zeropower.html">The zero-sum-power issue in the `hyper2` package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/RobinHankin/hyper2/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Generalized Plackett-Luce Likelihoods</h1>
                        <h4 data-toc-skip class="author">Robin K. S.
Hankin</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RobinHankin/hyper2/blob/master/vignettes/hyper3.Rmd" class="external-link"><code>vignettes/hyper3.Rmd</code></a></small>
      <div class="hidden name"><code>hyper3.Rmd</code></div>

    </div>

    
    
<p><img src="../../../_temp/Library/hyper2/help/figures/hyper2.png" width="20%" style="float:right; padding:10px"></p>
<p>To cite the <code>hyper2</code> package in publications, please use
<span class="citation">Hankin (2017)</span>; to cite <code>hyper3</code>
functionality, use <span class="citation">Hankin (2024)</span>.</p>
<p>The <code>hyper2</code> package provides functionality to work with
extensions of the Bradley-Terry probability model such as Plackett-Luce
likelihood including team strengths and reified entities (monsters). The
package allows one to use relatively natural R idiom to manipulate such
likelihood functions. Here, I present a generalization of
<code>hyper2</code> in which multiple entities are constrained to have
identical Bradley-Terry strengths. A new <code>S3</code> class
<code>hyper3</code>, along with associated methods, is motivated and
introduced. Three datasets are analysed, each analysis furnishing new
insight, and each highlighting different capabilities of the
package.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>hyper2</code> package <span class="citation">Hankin
(2017)</span> furnishes computational support for generalized
Plackett-Luce <span class="citation">(Plackett 1975)</span> likelihood
functions. The preferred interpretation is a race (as in track and field
athletics): Given six competitors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">1-6</annotation></semantics></math>,
we ascribe to them nonnegative strengths
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>p</mi><mn>6</mn></msub></mrow><annotation encoding="application/x-tex">p_1,\ldots, p_6</annotation></semantics></math>;
the probability that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
beats
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo>+</mo><msub><mi>p</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_i/(p_i+p_j)</annotation></semantics></math>.
It is conventional to normalise so that the total strength is unity, and
to identify a competitor with his strength. Given an order statistic,
say
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>≻</mo><msub><mi>p</mi><mn>2</mn></msub><mo>≻</mo><msub><mi>p</mi><mn>3</mn></msub><mo>≻</mo><msub><mi>p</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">p_1\succ p_2\succ p_3\succ
p_4</annotation></semantics></math>, the Plackett-Luce likelihood
function would be</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msub><mi>p</mi><mn>1</mn></msub><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><msub><mi>p</mi><mn>2</mn></msub><mo>+</mo><msub><mi>p</mi><mn>3</mn></msub><mo>+</mo><msub><mi>p</mi><mn>4</mn></msub></mrow></mfrac><mo>⋅</mo><mfrac><msub><mi>p</mi><mn>2</mn></msub><mrow><msub><mi>p</mi><mn>2</mn></msub><mo>+</mo><msub><mi>p</mi><mn>3</mn></msub><mo>+</mo><msub><mi>p</mi><mn>4</mn></msub></mrow></mfrac><mo>⋅</mo><mfrac><msub><mi>p</mi><mn>3</mn></msub><mrow><msub><mi>p</mi><mn>3</mn></msub><mo>+</mo><msub><mi>p</mi><mn>4</mn></msub></mrow></mfrac><mo>⋅</mo><mfrac><msub><mi>p</mi><mn>4</mn></msub><msub><mi>p</mi><mn>4</mn></msub></mfrac><mspace width="2.0em"></mspace><mtext mathvariant="normal">Plackett-Luce</mtext></mrow><annotation encoding="application/x-tex">\begin{equation}\label{PL_like}
  \frac{p_1}{p_1+p_2+p_3+p_4}\cdot
  \frac{p_2}{    p_2+p_3+p_4}\cdot
  \frac{p_3}{        p_3+p_4}\cdot
  \frac{p_4}{            p_4}
  \qquad\mbox{Plackett-Luce}
\end{equation}</annotation></semantics></math></p>
<p><span class="citation">Mollica and Tardella (2014)</span> call this a
forward ranking process on the grounds that the best (preferred;
fastest; chosen) entities are identified in the same sequence as their
rank.</p>
<p>Computational support for Bradley-Terry likelihood functions is
available in a range of languages. <span class="citation">Hunter
(2004)</span>, for example, presents results in <code>MATLAB</code>
[although he works with a nonlinear extension to account for ties];
<span class="citation">Allison and Christakis (1994)</span> present
related work for ranking statistics in <code>SAS</code> and <span class="citation">Maystre (2022)</span> has released a
<code>python</code> package for Luce-type choice datasets.</p>
<p>However, the majority of software is written in the R computer
language <span class="citation">( Core Team 2023)</span>, which includes
extensive functionality for working with such likelihood functions:
<span class="citation">Turner et al. (2020)</span> discuss several
implementations from a computational perspective. The
<code>BradleyTerry</code> package <span class="citation">(Firth
2005)</span> considers pairwise comparisons using but cannot deal with
ties or player-specific predictors; the package <span class="citation">(Turner and Firth 2012)</span> implements a flexible
user interface and wider range of models to be fitted to pairwise
comparison datasets, specifically simple random effects. The package
<span class="citation">(Turner et al. 2020)</span> generalizes this to
likelihood functions of the form of the Plackett-Luce equation above,
and applies the Poisson transformation of <span class="citation">(Baker
1994)</span> to express the problem as a log-linear model. The package,
in contrast, gives a consistent language interface to create and
manipulate likelihood functions over the simplex
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>n</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>p</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>p</mi><mi>i</mi></msub><mo>≥</mo><mn>0</mn><mo>,</mo><mo>∑</mo><msub><mi>p</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">{S}_n=\left\lbrace\left(p_1,\ldots,p_n\right)\left|p_i\geq 0,\sum
p_i=1\right.\right\rbrace</annotation></semantics></math>. A further
extension in the package generalizes this likelihood function to
functions of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐩</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>p</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">{\mathbf
p}=(p_1,\ldots,p_n)</annotation></semantics></math> with</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℒ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐩</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>∏</mo><mrow><mi>s</mi><mo>∈</mo><mi>𝒪</mi></mrow></munder><msup><mrow><mo stretchy="true" form="prefix">(</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>s</mi></mrow></munder><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>n</mi><mi>s</mi></msub></msup><mspace width="2.0em"></mspace><mtext mathvariant="normal">Hyperdirichlet likelihood</mtext></mrow><annotation encoding="application/x-tex">\begin{equation}\label{hyper2likelihood}
\mathcal{L}\left(\mathbf{p}\right)=
\prod_{s\in \mathcal{O}}\left({\sum_{i\in s}}p_i\right)^{n_s}\qquad\mbox{Hyperdirichlet likelihood}
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝒪</mi><annotation encoding="application/x-tex">\mathcal{O}</annotation></semantics></math>
is a set of observations and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
a subset of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>n</mi><mo stretchy="true" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\left\{1,2,\ldots,n\right\}</annotation></semantics></math>;
numbers
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>s</mi></msub><annotation encoding="application/x-tex">n_s</annotation></semantics></math>
are integers which may be positive or negative. The package has the
ability to evaluate such likelihood functions at any point in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mi>n</mi></msub><annotation encoding="application/x-tex">S_n</annotation></semantics></math>,
thereby admitting a wide range of non-standard nulls such as order
statistics on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>i</mi></msub><annotation encoding="application/x-tex">p_i</annotation></semantics></math><span class="citation">(Hankin 2017)</span>. It becomes possible to
analyse a wider range of likelihood functions than standard
Plackett-Luce <span class="citation">(Turner et al. 2020)</span>. For
example, results involving incomplete order statistics or teams are
tractable. Further, the introduction of reified entities (monsters)
allows one to consider draws <span class="citation">(Hankin
2010)</span>, noncompetitive tactics such as collusion <span class="citation">(Hankin 2020)</span>, and the phenomenon of team
cohesion wherein the team becomes stronger than the sum of its parts
<span class="citation">(Hankin 2010)</span>. Recent versions of the
package include experimental functionality <code><a href="../reference/ordervec2supp3.html">cheering()</a></code> to
investigate the relaxing of the assumption of conditional independence
of the forward-ranking process.</p>
<p>Here I present a different generalization. Consider a race in which
there are six runners 1-6 but we happen to know that three of the
runners (1,2,3) are clones of strength
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>a</mi></msub><annotation encoding="application/x-tex">p_a</annotation></semantics></math>,
two of the runners (4,5) have strength
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>b</mi></msub><annotation encoding="application/x-tex">p_b</annotation></semantics></math>,
and the final runner (6) is of strength
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>c</mi></msub><annotation encoding="application/x-tex">p_c</annotation></semantics></math>.
We normalise so
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>a</mi></msub><mo>+</mo><msub><mi>p</mi><mi>b</mi></msub><mo>+</mo><msub><mi>p</mi><mi>c</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p_a+p_b+p_c=1</annotation></semantics></math>.
The runners race and the finishing order is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>≻</mo><mi>c</mi><mo>≻</mo><mi>b</mi><mo>≻</mo><mi>a</mi><mo>≻</mo><mi>a</mi><mo>≻</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a\succ c\succ b\succ a\succ a \succ b</annotation></semantics></math></p>
<p>Thus the winner was
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>,
second place for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>,
third for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>,
and so on. Alternatively we might say that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
came first, fourth, and fifth;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
came third and sixth, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
came second. The Plackett-Luce likelihood function for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>a</mi></msub><mo>,</mo><msub><mi>p</mi><mi>b</mi></msub><mo>,</mo><msub><mi>p</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">p_a,p_b,p_c</annotation></semantics></math>
would be</p>
<p><span class="math display">$$\begin{equation}\label{plackettluce}
\frac{p_a}{3p_a+2p_b+p_c}\cdot
\frac{p_c}{2p_a+2p_b+p_c}\cdot
\frac{p_b}{2p_a+2p_b    }\cdot
\frac{p_a}{2p_a+ p_b    }\cdot
\frac{p_a}{ p_a+
p_b\vphantom{x_{x_{x_{x_{x_{x_{x_{x_{x_{x_{x_{x_{x_{x_{x_{x_{x_{x}}}}}}}}}}}}}}}}}}
                        }\cdot
\frac{p_b}{      p_b    },\qquad p_a+p_b+p_c=1\\
\mbox{generalized plackett-Luce likelihood}
\end{equation}$$</span></p>
<p>Here I consider such generalized Plackett-Luce likelihood functions,
and give an exact analysis of several simple cases. I then show how this
class of likelihood functions may be applied to a range of inference
problems involving order statistics. Illustrative examples, drawn from
Formula 1 motor racing, and track-and-field athletics, are given.</p>
<div class="section level3">
<h3 id="computational-methodology-for-generalized-plackett-luce-likelihood-functions">Computational methodology for generalized Plackett-Luce likelihood
functions<a class="anchor" aria-label="anchor" href="#computational-methodology-for-generalized-plackett-luce-likelihood-functions"></a>
</h3>
<p>Existing formalism as described by <span class="citation">Hankin
(2017)</span> cannot represent the Plackett-Luce likelihood equation,
because Equation the hyperdirichlet likelihood equation uses sets as the
indexing elements, and in this case we need multisets. The
declarations</p>
<pre><code>typedef map&lt;string, long double&gt; weightedplayervector;
typedef map&lt;weightedplayervector, long double&gt; hyper3;</code></pre>
<p>show how the class of the Standard Template Library is used with
objects mapping strings to long doubles (specifically, mapping player
names to their multiplicities), and objects of class are maps from a
object to long doubles. One advantage of this is efficiency: Search,
removal, and insertion operations have logarithmic complexity. As an
example, the following pseudo code would create a log-likelihood
function for the first term in the Plackett-Luce likelihood equation
above:</p>
<pre><code>weightedplayervector n,d;
n["a"] = 1; 
d["a"] = 3; 
d["b"] = 2;
d["c"] = 1;

hyper3 L;
L[n] = 1;
L[d] = -1;</code></pre>
<p>Above, we understand and to represent numerator and denominator
respectively. Object is an object of class ; it may be evaluated at
points in probability space [that is, a vector of nonnegative values
with unit sum] using standard idiom wrapping back end.</p>
</div>
<div class="section level3">
<h3 id="package-implementation">Package implementation<a class="anchor" aria-label="anchor" href="#package-implementation"></a>
</h3>
<p>The package includes an <code>S3</code> class <code>hyper3</code> for
this type of object; extraction and replacement methods use
<code>disordR</code> discipline [<span class="citation">Hankin
(2022)</span>}. Package idiom for creating such objects uses named
vectors:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hyper3.html">hyper3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">LL</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">LL</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">3</span>, b <span class="op">=</span> <span class="fl">2</span>, c <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">LL</span></span></code></pre></div>
<pre><code><span><span class="co">## log( (a=1)^1 * (a=3, b=2, c=1)^-1)</span></span></code></pre>
<p>Above, we see object is a log-likelihood function of the players’
strengths, which may be evaluated at specified points in probability
space. A typical use-case would be to assess
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub><mo>:</mo><msub><mi>p</mi><mi>a</mi></msub><mo>=</mo><mn>0.9</mn><mo>,</mo><msub><mi>p</mi><mi>b</mi></msub><mo>=</mo><mn>0.05</mn><mo>,</mo><msub><mi>p</mi><mi>c</mi></msub><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">H_1\colon
p_a=0.9,p_b=0.05,p_c=0.05</annotation></semantics></math> and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>2</mn></msub><mo>:</mo><msub><mi>p</mi><mi>a</mi></msub><mo>=</mo><mn>0.01</mn><mo>,</mo><msub><mi>p</mi><mi>b</mi></msub><mo>=</mo><mn>0.01</mn><mo>,</mo><msub><mi>p</mi><mi>c</mi></msub><mo>=</mo><mn>0.98</mn></mrow><annotation encoding="application/x-tex">H_2\colon p_a=0.01,p_b=0.01,p_c=0.98</annotation></semantics></math>,
and we may evaluate these hypotheses using generic function :</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/loglik.html">loglik</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0.01</span>, b <span class="op">=</span> <span class="fl">0.01</span>, c <span class="op">=</span> <span class="fl">0.98</span><span class="op">)</span>, <span class="va">LL</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -4.634729</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/loglik.html">loglik</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0.90</span>, b <span class="op">=</span> <span class="fl">0.05</span>, c <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>, <span class="va">LL</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -1.15268</span></span></code></pre>
<p>Thus we prefer
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>
over
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>2</mn></msub><annotation encoding="application/x-tex">H_2</annotation></semantics></math>
with about 3.5 units of support, satisfying the standard two units of
support criterion <span class="citation">(Edwards 1972)</span>, and we
conclude that our observation [in this case, that one of the three
clones of player
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
beat the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
twins and the singleton
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>]
furnishes strong support against
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>2</mn></msub><annotation encoding="application/x-tex">H_2</annotation></semantics></math>
in favour of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>.</p>
<p>The package includes many helper functions to work with order
statistics of this type. Function , for example, can be used to generate
a Plackett-Luce log-likelihood function:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ordervec2supp3.html">ordervec2supp3</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## log( (a=1)^3 * (a=1, b=1)^-1 * (a=2, b=1)^-1 * (a=2, b=2)^-1 * (a=2,</span></span>
<span><span class="co">## b=2, c=1)^-1 * (a=3, b=2, c=1)^-1 * (b=1)^1 * (c=1)^1)</span></span></code></pre>
<p>(the package gives extensive documentation at ). We may find a
maximum likelihood estimate for the players’ strengths, using generic
function , dispatching to a specialist method:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">mH</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/maxp.html">maxp</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          a          b          c </span></span>
<span><span class="co">## 0.21324090 0.08724824 0.69951086</span></span></code></pre>
<p>(function uses standard optimization techniques to locate the
evaluate; it has access to first derivatives of the log-likelihood and
as such has rapid convergence, if its objective function is reasonably
smooth).</p>
<p>The package provides a number of statistical tests on likelihood
functions, modified from <span class="citation">Hankin (2017)</span> to
work with objects. For example, we may assess the hypothesis that all
three players are of equal strength [viz
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>p</mi><mi>a</mi></msub><mo>=</mo><msub><mi>p</mi><mi>b</mi></msub><mo>=</mo><msub><mi>p</mi><mi>c</mi></msub><mo>=</mo><mfrac><mn>1</mn><mn>3</mn></mfrac></mrow><annotation encoding="application/x-tex">H_0\colon
p_a=p_b=p_c=\frac{1}{3}</annotation></semantics></math>]:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tests.html">equalp.test</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Constrained support maximization</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  H</span></span>
<span><span class="co">## null hypothesis: a = b = c</span></span>
<span><span class="co">## null estimate:</span></span>
<span><span class="co">##         a         b         c </span></span>
<span><span class="co">## 0.3333333 0.3333333 0.3333333 </span></span>
<span><span class="co">## (argmax, constrained optimization)</span></span>
<span><span class="co">## Support for null:  -6.579251 + K</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## alternative hypothesis:  sum p_i=1 </span></span>
<span><span class="co">## alternative estimate:</span></span>
<span><span class="co">##          a          b          c </span></span>
<span><span class="co">## 0.21324090 0.08724824 0.69951086 </span></span>
<span><span class="co">## (argmax, free optimization)</span></span>
<span><span class="co">## Support for alternative:  -5.73209 + K</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## degrees of freedom: 2</span></span>
<span><span class="co">## support difference = 0.8471613</span></span>
<span><span class="co">## p-value: 0.42863</span></span></code></pre>
<p>showing, perhaps unsurprisingly, that this small dataset is
consistent with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="package-helper-functions">Package helper functions<a class="anchor" aria-label="anchor" href="#package-helper-functions"></a>
</h3>
<p>Arithmetic operations are implemented for <code>hyper3</code> objects
in much the same way as for <code>hyper2</code> objects: independent
observations may be combined using the overloaded <code>+</code>
operator; an example is given below.</p>
<p>The original motivation for <code>hyper3</code> was the analysis of
Formula 1 motor racing, and the package accordingly includes wrappers
for <code><a href="https://robinhankin.github.io/hyper2/reference/ordertable2supp.html" class="external-link">ordervec2supp()</a></code> such as <code><a href="../reference/ordervec2supp3.html">ordertable2supp3()</a></code>
and <code><a href="../reference/attemptstable2supp3.html">attemptstable2supp3()</a></code> which facilitate the analysis of
commonly encountered result formats. Package documentation for order
tables is given at <code>ordertable.Rd</code> and an example is given
below.</p>
</div>
</div>
<div class="section level2">
<h2 id="exact-analytical-solution-for-some-simple-generalized-plackett-luce-likelihood-functions">Exact analytical solution for some simple generalized Plackett-Luce
likelihood functions<a class="anchor" aria-label="anchor" href="#exact-analytical-solution-for-some-simple-generalized-plackett-luce-likelihood-functions"></a>
</h2>
<p>Here I consider some order statistics with nontrivial maximum
likelihood Bradley-Terry strengths. The simplest nontrivial case would
be three competitors with strengths
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a,a,b</annotation></semantics></math>
and finishing order
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>≻</mo><mi>b</mi><mo>≻</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">a\succ b\succ a</annotation></semantics></math>.
The Plackett-Luce likelihood function would be</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>a</mi><mrow><mn>2</mn><mi>a</mi><mo>+</mo><mi>b</mi></mrow></mfrac><mo>⋅</mo><mfrac><mi>b</mi><mrow><mi>a</mi><mo>+</mo><mi>b</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\begin{equation}\label{aba}
\frac{a}{2a+b}\cdot\frac{b}{a+b}
\end{equation}</annotation></semantics></math></p>
<p>and in this case we know that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>+</mo><mi>b</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a+b=1</annotation></semantics></math>
so this is equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℒ</mi><mo>=</mo><mi>ℒ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mi>a</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\mathcal{L}=\mathcal{L}(a)=\frac{a(1-a)}{1+a}</annotation></semantics></math>.
The score would be given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>ℒ</mi></mrow><mrow><mi>d</mi><mi>a</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mn>2</mn><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac><mo>=</mo><mfrac><mrow><mn>1</mn><mo>−</mo><mn>2</mn><mi>a</mi><mo>−</mo><msup><mi>a</mi><mn>2</mn></msup></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">\begin{equation}\label{aba_mle}
\frac{d\mathcal{L}}{da}=\frac{(1+a)(1-2a)-a(1-a)}{(1+a)^2}=
\frac{1-2a-a^2}{(1+a)^2}
\end{equation}</annotation></semantics></math></p>
<p>and this will be zero at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mn>2</mn></msqrt><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sqrt{2}-1</annotation></semantics></math>;
we also note that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>d</mi><mn>2</mn></msup><mi>ℒ</mi><mi>/</mi><mi>d</mi><msup><mi>a</mi><mn>2</mn></msup><mo>=</mo><mo>−</mo><mn>4</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">d^2\mathcal{L}/da^2=-4(1+a)^{-3}</annotation></semantics></math>,
manifestly strictly negative for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>a</mi><mo>≤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0\leq a\leq 1</annotation></semantics></math>:
the root is a maximum.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/maxp.html">maxp</a></span><span class="op">(</span><span class="fu"><a href="../reference/ordervec2supp3.html">ordervec2supp3</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"a"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         a         b </span></span>
<span><span class="co">## 0.4142108 0.5857892</span></span></code></pre>
<p>Above, we see close agreement with the theoretical value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><mn>2</mn></msqrt><mo>−</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>−</mo><msqrt><mn>2</mn></msqrt><mo stretchy="true" form="postfix">)</mo></mrow><mo>≃</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.414</mn><mo>,</mo><mn>0.586</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(\sqrt{2}-1,2-\sqrt{2})\simeq (0.414,0.586)</annotation></semantics></math>.
Observe that the maximum likelihood estimate for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
is strictly less than 0.5, even though the finishing order is symmetric.
Using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℒ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mi>a</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\mathcal{L}(a)=\frac{a(1-a)}{1+a}</annotation></semantics></math>,
we can show that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mi>ℒ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>a</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>3</mn><mo>−</mo><mn>2</mn><msqrt><mn>2</mn></msqrt><mo stretchy="true" form="postfix">)</mo></mrow><mo>≃</mo><mo>−</mo><mn>1.76</mn></mrow><annotation encoding="application/x-tex">\log\mathcal{L}(\hat{a})=\log\left(3-2\sqrt{2}\right)\simeq -1.76</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>a</mi><mo accent="true">̂</mo></mover><mo>=</mo><msqrt><mn>2</mn></msqrt><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\hat{a}=\sqrt{2}-1</annotation></semantics></math>
is the maximum likelihood estimate for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>.
Defining
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒮</mi><mo>=</mo><mo>log</mo><mi>ℒ</mi></mrow><annotation encoding="application/x-tex">\mathcal{S}=\log\mathcal{L}</annotation></semantics></math>
as the support [log-likelihood] we have</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒮</mi><mo>=</mo><mi>𝒮</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mi>a</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>3</mn><mo>−</mo><mn>2</mn><msqrt><mn>2</mn></msqrt><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation}
\mathcal{S}=\mathcal{S}(a)=\log\left(\frac{a(1-a)}{1+a}\right)-\log\left(3-2\sqrt{2}\right)
\end{equation}</annotation></semantics></math></p>
<p>as a standard support function which has a maximum value of zero when
evaluated at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>a</mi><mo accent="true">̂</mo></mover><mo>=</mo><msqrt><mn>2</mn></msqrt><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\hat{a}=\sqrt{2}-1</annotation></semantics></math>.
For example, we can test the null that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mi>b</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">a=b=\frac{1}{2}</annotation></semantics></math>,
the statement that the competitors have equal Bradley-Terry
strengths:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span> <span class="co"># null</span></span>
<span><span class="op">(</span><span class="va">S_delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">a</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">a</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">a</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">3</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.0290123</span></span></code></pre>
<p>Thus the additional support gained in moving from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">a=\frac{1}{2}</annotation></semantics></math>
to the evaluate of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><msqrt><mn>2</mn></msqrt><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a=\sqrt{2}-1</annotation></semantics></math>
is 0.029, rather small [as might be expected given that we have only one
rather uninformative observation, and also given that the maximum
likelihood estimate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≃</mo><mn>0.41</mn></mrow><annotation encoding="application/x-tex">\simeq 0.41</annotation></semantics></math>)
is quite close to the null of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.5</mn><annotation encoding="application/x-tex">0.5</annotation></semantics></math>].
Nevertheless we can follow [<span class="citation">Edwards
(1972)</span>} and apply Wilks’s theorem for a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
value:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span> <span class="op">*</span> <span class="va">S_delta</span>, df <span class="op">=</span> <span class="fl">1</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.8096458</span></span></code></pre>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
is about 0.81, exceeding 0.05; thus we have no strong evidence to reject
the null of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">a=\frac{1}{2}</annotation></semantics></math>.
The observation is informative, in the sense that we can find a credible
interval for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>.
With an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>-units
of support criterion the analytical solution to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒮</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>−</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\mathcal{S}(p)=-n</annotation></semantics></math>
is given by defining
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>3</mn><mo>−</mo><mn>2</mn><msqrt><mn>2</mn></msqrt><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">X=\log(3-2\sqrt{2})-n</annotation></semantics></math>
and solving
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">p(1-p)/(1+p)=X</annotation></semantics></math>,
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mo>±</mo></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>X</mi><mo>±</mo><msqrt><mrow><mn>1</mn><mo>+</mo><mn>4</mn><mi>X</mi><mo>+</mo><msup><mi>X</mi><mn>2</mn></msup></mrow></msqrt><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">p_\pm=\left(1-X\pm\sqrt{1+4X+X^2}\right)/2</annotation></semantics></math>,
the two roots being the lower and upper limits of the credible interval;
see the figure below.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, by <span class="op">=</span> <span class="fl">0.005</span>, to <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">a</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">a</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">a</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">3</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a</span>, <span class="fu">S</span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'b'</span>,xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="va">a</span><span class="op">]</span><span class="op">)</span>,ylab<span class="op">=</span><span class="st">"support"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02438102</span>, <span class="fl">0.9524271</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="hyper3_files/figure-html/unnamed-chunk-1-1.png" alt="A support function for a&gt;b&gt;a" width="672"><p class="caption">
A support function for a&gt;b&gt;a
</p>
</div>
<div class="section level3">
<h3 id="fisher-information">Fisher information<a class="anchor" aria-label="anchor" href="#fisher-information"></a>
</h3>
<p>If we have two clones of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
and a singleton
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>,
then there are three possible rank statistics: (i),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>≻</mo><mi>a</mi><mo>≻</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a\succ a\succ b</annotation></semantics></math>
with probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mn>2</mn><msup><mi>a</mi><mn>2</mn></msup></mrow><mrow><mn>1</mn><mo>+</mo><mi>a</mi></mrow></mfrac><annotation encoding="application/x-tex">\frac{2a^2}{1+a}</annotation></semantics></math>;
(ii),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>≻</mo><mi>b</mi><mo>≻</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">a\succ b\succ a</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mn>2</mn><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mfrac><annotation encoding="application/x-tex">\frac{2a(1-a)}{(1+a)}</annotation></semantics></math>,
(iii),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>≻</mo><mi>a</mi><mo>≻</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">b\succ a\succ a</annotation></semantics></math>
at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mn>1</mn><mo>−</mo><mi>a</mi></mrow><mrow><mn>1</mn><mo>+</mo><mi>a</mi></mrow></mfrac><annotation encoding="application/x-tex">\frac{1-a}{1+a}</annotation></semantics></math>.
Likelihood functions for these order statistics are given in the figure
below. It can be shown that the Fisher information for such observations
is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℐ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>2</mn><mfrac><mrow><mn>1</mn><mo>+</mo><mi>a</mi><mo>+</mo><msup><mi>a</mi><mn>2</mn></msup></mrow><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\begin{equation}
\mathcal{I}(a)=2\frac{1+a+a^2}{a(1-a)(1+a)^2}
\end{equation}</annotation></semantics></math></p>
<p>which has a minimum of about
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>6.21</mn><annotation encoding="application/x-tex">6.21</annotation></semantics></math>
at at about
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mn>0.522</mn></mrow><annotation encoding="application/x-tex">a=0.522</annotation></semantics></math>.
We can compare this with the Fisher information matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ℐ</mi><annotation encoding="application/x-tex">{\mathcal I}</annotation></semantics></math>,
for the case of three distinct runners
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">a,b,c</annotation></semantics></math>,
evaluated at its minimum of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>a</mi></msub><mo>=</mo><msub><mi>p</mi><mi>b</mi></msub><mo>=</mo><msub><mi>p</mi><mi>c</mi></msub><mo>=</mo><mfrac><mn>1</mn><mn>3</mn></mfrac></mrow><annotation encoding="application/x-tex">p_a=p_b=p_c=\frac{1}{3}</annotation></semantics></math>.
If we observe the complete order statistic,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>ℐ</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>=</mo><mfrac><mn>1323</mn><mn>16</mn></mfrac><mo>≃</mo><mn>82.7</mn></mrow><annotation encoding="application/x-tex">\left|{\mathcal I}\right| =\frac{1323}{16}\simeq 82.7</annotation></semantics></math>;
if we observe just the winner,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>ℐ</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>=</mo><mn>27</mn></mrow><annotation encoding="application/x-tex">\left|{\mathcal I}\right|=27</annotation></semantics></math>,
and if we observe just the loser we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>ℐ</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>=</mo><mfrac><mn>16875</mn><mn>256</mn></mfrac><mo>≃</mo><mn>65.9</mn></mrow><annotation encoding="application/x-tex">\left|{\mathcal
I}\right|=\frac{16875}{256}\simeq 65.9</annotation></semantics></math>.
A brief discussion is given at .</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f_aab</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">{</span><span class="va">a</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">a</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">f_aba</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">{</span><span class="va">a</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">a</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">a</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">f_baa</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">{</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">a</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">a</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">f</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, by <span class="op">=</span> <span class="fl">0.005</span>, to <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">a</span>, <span class="fu">f</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="va">a</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Likelihood"</span>, type <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu">p</span><span class="op">(</span><span class="va">f_aab</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="fu">p</span><span class="op">(</span><span class="va">f_aba</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu">p</span><span class="op">(</span><span class="va">f_baa</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="st">"AAB"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.4</span>,<span class="st">"ABA"</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.05</span>,<span class="st">"BAA"</span>,col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="hyper3_files/figure-html/unnamed-chunk-2-1.png" alt="Support functions for observations a&gt;a&gt;b, a&gt;b&gt;a and b&gt;a&gt;a.  Horizontal dotted line represents two units of support" width="672"><p class="caption">
Support functions for observations a&gt;a&gt;b, a&gt;b&gt;a and
b&gt;a&gt;a. Horizontal dotted line represents two units of support
</p>
</div>
</div>
<div class="section level3">
<h3 id="nonfinishers">Nonfinishers<a class="anchor" aria-label="anchor" href="#nonfinishers"></a>
</h3>
<p>If we allow non-finishers—that is, a subset of competitors who are
beaten by all the ranked competitors ([<span class="citation">Turner et
al. (2020)</span>} call this a {}), there is another nontrivial order
statistic, viz
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>≻</mo><mi>b</mi><mo>≻</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">a\succ b\succ\left\lbrace a,b\right\rbrace</annotation></semantics></math>
[thus one of the two
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>’s
won, one of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>’s
came second, and one of each of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
failed to finish]. Now</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℒ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>a</mi><mrow><mn>2</mn><mi>a</mi><mo>+</mo><mn>2</mn><mi>b</mi></mrow></mfrac><mo>⋅</mo><mfrac><mi>b</mi><mrow><mi>a</mi><mo>+</mo><mn>2</mn><mi>b</mi></mrow></mfrac><mo>∝</mo><mfrac><mrow><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>2</mn><mo>−</mo><mi>a</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\begin{equation}
\mathcal{L}(a)=
\frac{a}{2a+2b}\cdot
\frac{b}{ a+2b}\propto\frac{a(1-a)}{2-a}
\end{equation}</annotation></semantics></math></p>
<p>(see how the likelihood function is actually simpler than for the
complete order statistic). The evaluate would be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>−</mo><msqrt><mn>2</mn></msqrt><mo>≃</mo><mn>0.586</mn></mrow><annotation encoding="application/x-tex">2-\sqrt{2}\simeq
0.586</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/maxp.html">maxp</a></span><span class="op">(</span><span class="fu"><a href="../reference/ordervec2supp3.html">ordervec2supp3</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, nonfinishers<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         a         b </span></span>
<span><span class="co">## 0.5857892 0.4142108</span></span></code></pre>
<p>The Fisher information for such observations has a minimum of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>68</mn><mn>9</mn></mfrac><mo>≃</mo><mn>7.56</mn></mrow><annotation encoding="application/x-tex">\frac{68}{9}\simeq 7.56</annotation></semantics></math>
at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">a=\frac{1}{2}</annotation></semantics></math>.
An inference problem for a dataset including nonfinishers will be given
below.</p>
</div>
</div>
<div class="section level2">
<h2 id="an-alternative-to-the-mann-whitney-test-using-generalized-plackett-luce-likelihood">An alternative to the Mann-Whitney test using generalized
Plackett-Luce likelihood<a class="anchor" aria-label="anchor" href="#an-alternative-to-the-mann-whitney-test-using-generalized-plackett-luce-likelihood"></a>
</h2>
<p>The ideas presented above can easily be extended to arbitrarily large
numbers of competitors, although the analytical expressions tend to be
intractable and numerical methods must be used. All results and datasets
presented here are maintained under version control and available at
<code>https://github.com/RobinHankin/hyper2</code>. Given an order
statistic of the type considered above, the Mann-Whitney-Wilcoxon test
<span class="citation">(Mann and Whitney 1947, wilcoxon1945)</span>
assesses a null of identity of underlying distributions <span class="citation">(Ahmad 1996)</span>. Consider the chorioamnion dataset
<span class="citation">(Hollander, Wolfe, and Chicken 2013)</span>, used
in <code>wilcox.test.Rd</code>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.80</span>, <span class="fl">0.83</span>, <span class="fl">1.89</span>, <span class="fl">1.04</span>, <span class="fl">1.45</span>, <span class="fl">1.38</span>, <span class="fl">1.91</span>, <span class="fl">1.64</span>, <span class="fl">0.73</span>, <span class="fl">1.46</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.15</span>, <span class="fl">0.88</span>, <span class="fl">0.90</span>, <span class="fl">0.74</span>, <span class="fl">1.21</span><span class="op">)</span></span></code></pre></div>
<p>Here we see a measure of permeability of the human placenta at term
(<code>x</code>) and between 3 and 6 months’ gestational age
(<code>y</code>). The order statistic is straightforward to
calculate:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="fu"><a href="../reference/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="fu"><a href="../reference/length.html">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">os</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "x" "y" "x" "x" "y" "y" "x" "y" "y" "x" "x" "x" "x" "x" "x"</span></span></code></pre>
<p>Then object <code>os</code> is converted to a <code>hyper3</code>
object, again with <code><a href="../reference/ordervec2supp3.html">ordervec2supp3()</a></code>, which may be assessed
using the Method of Support:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Hxy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ordervec2supp3.html">ordervec2supp3</a></span><span class="op">(</span><span class="va">os</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/tests.html">equalp.test</a></span><span class="op">(</span><span class="va">Hxy</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Constrained support maximization</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  Hxy</span></span>
<span><span class="co">## null hypothesis: x = y</span></span>
<span><span class="co">## null estimate:</span></span>
<span><span class="co">##   x   y </span></span>
<span><span class="co">## 0.5 0.5 </span></span>
<span><span class="co">## (argmax, constrained optimization)</span></span>
<span><span class="co">## Support for null:  -27.89927 + K</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## alternative hypothesis:  sum p_i=1 </span></span>
<span><span class="co">## alternative estimate:</span></span>
<span><span class="co">##         x         y </span></span>
<span><span class="co">## 0.2401539 0.7598461 </span></span>
<span><span class="co">## (argmax, free optimization)</span></span>
<span><span class="co">## Support for alternative:  -26.48443 + K</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## degrees of freedom: 1</span></span>
<span><span class="co">## support difference = 1.414837</span></span>
<span><span class="co">## p-value: 0.09253716</span></span></code></pre>
<p>Above, we use generic function <code><a href="../reference/tests.html">equalp.test()</a></code> to test the
null that the permeability of the two groups both have Bradley-Terry
strength of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.5</mn><annotation encoding="application/x-tex">0.5</annotation></semantics></math>.
We see a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
value of about 0.09; compare 0.25 from <code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test()</a></code>.
However, observe that the <code>hyper3</code> likelihood approach gives
more information than Wilcoxon’s analysis: Firstly, we see that the
maximum likelihood estimate for the Bradley-Terry strength of
<code>x</code> is about 0.24, considerably less than the null of 0.5;
further, we may plot a support curve for this dataset, given in the
figure below.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0.02</span>, to <span class="op">=</span> <span class="fl">0.8</span>, len <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">a</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="../reference/loglik.html">loglik</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">Hxy</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">L</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'b'</span>,xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="va">a</span><span class="op">]</span><span class="op">)</span>,ylab<span class="op">=</span><span class="st">"likelihood"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.24</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="hyper3_files/figure-html/unnamed-chunk-3-1.png" alt="A support function for the Bradley-Terry strength of permeability at term.  The evaluate of 0.24 is shown; and the two-units-of support credible interval, which does not exclude the null of strength 0.5 (dotted line), is also shown" width="672"><p class="caption">
A support function for the Bradley-Terry strength of permeability at
term. The evaluate of 0.24 is shown; and the two-units-of support
credible interval, which does not exclude the null of strength 0.5
(dotted line), is also shown
</p>
</div>
<div class="section level3">
<h3 id="a-generalization-of-the-mann-whitney-test-using-generalized-plackett-luce-likelihood">A generalization of the Mann-Whitney test using generalized
Plackett-Luce likelihood<a class="anchor" aria-label="anchor" href="#a-generalization-of-the-mann-whitney-test-using-generalized-plackett-luce-likelihood"></a>
</h3>
<p>The ideas presented above may be extended to more than two types of
competitors. Consider the following table, drawn from the men’s javelin,
2020 Olympics:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">javelin_table</span></span></code></pre></div>
<pre><code><span><span class="co">##           throw1 throw2 throw3 throw4 throw5 throw6</span></span>
<span><span class="co">## Chopra     87.03  87.58  76.79      X      X  84.24</span></span>
<span><span class="co">## Vadlejch   83.98      X      X  82.86  86.67      X</span></span>
<span><span class="co">## Vesely     79.73  80.30  85.44      X  84.98      X</span></span>
<span><span class="co">## Weber      85.30  77.90  78.00  83.10  85.15  75.72</span></span>
<span><span class="co">## Nadeem     82.40      X  84.62  82.91  81.98      X</span></span>
<span><span class="co">## Katkavets  82.49  81.03  83.71  79.24      X      X</span></span>
<span><span class="co">## Mardare    81.16  81.73  82.84  81.90  83.30  81.09</span></span>
<span><span class="co">## Etelatalo  78.43  76.59  83.28  79.20  79.99  83.05</span></span></code></pre>
<p>Thus Chopra threw 87.03m on his first throw, 87.58m on his second,
and so on. No-throws, ignored here, are indicated with an
<code>X</code>. We may convert this to a named vector with elements
being the throw distances, and names being the competitors, using
<code><a href="../reference/attemptstable2supp3.html">attemptstable2supp3()</a></code>:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">javelin_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/attemptstable2supp3.html">attemptstable2supp3</a></span><span class="op">(</span><span class="va">javelin_table</span>,</span>
<span>       decreasing <span class="op">=</span> <span class="cn">TRUE</span>, give.supp <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span>
<span><span class="va">javelin_vector</span></span></code></pre></div>
<pre><code><span><span class="co">##    Chopra    Chopra  Vadlejch    Vesely     Weber     Weber </span></span>
<span><span class="co">##     87.58     87.03     86.67     85.44     85.30     85.15 </span></span>
<span><span class="co">##    Vesely    Nadeem    Chopra  Vadlejch Katkavets   Mardare </span></span>
<span><span class="co">##     84.98     84.62     84.24     83.98     83.71     83.30 </span></span>
<span><span class="co">## Etelatalo     Weber Etelatalo    Nadeem  Vadlejch   Mardare </span></span>
<span><span class="co">##     83.28     83.10     83.05     82.91     82.86     82.84 </span></span>
<span><span class="co">## Katkavets    Nadeem    Nadeem   Mardare   Mardare   Mardare </span></span>
<span><span class="co">##     82.49     82.40     81.98     81.90     81.73     81.16 </span></span>
<span><span class="co">##   Mardare Katkavets    Vesely Etelatalo    Vesely Katkavets </span></span>
<span><span class="co">##     81.09     81.03     80.30     79.99     79.73     79.24 </span></span>
<span><span class="co">## Etelatalo Etelatalo     Weber     Weber    Chopra Etelatalo </span></span>
<span><span class="co">##     79.20     78.43     78.00     77.90     76.79     76.59 </span></span>
<span><span class="co">##     Weber  Vadlejch    Nadeem  Vadlejch    Chopra    Vesely </span></span>
<span><span class="co">##     75.72        NA        NA        NA        NA        NA </span></span>
<span><span class="co">##    Chopra Katkavets  Vadlejch    Vesely    Nadeem Katkavets </span></span>
<span><span class="co">##        NA        NA        NA        NA        NA        NA</span></span></code></pre>
<p>Above we see that Chopra threw the longest and second-longest throws
of 87.58m and 87.03 respectively; Vadlejch threw the third-longest throw
of 86.67m, and so on (<code>NA</code> entries correspond to no-throws.)
The attempts table may be converted to a <code>hyper3</code> object,
again using function <code><a href="../reference/attemptstable2supp3.html">attemptstable2supp3()</a></code> but this time
passing <code>give.supp=TRUE</code>:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">javelin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ordervec2supp3.html">ordervec2supp3</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">javelin_vector</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">javelin_vector</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Above, object <code>javelin</code> is a <code>hyper3</code>
likelihood function, so one has access to the standard likelihood-based
methods, such as finding and displaying the maximum likelihood estimate,
shown in the figure below.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">mj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/maxp.html">maxp</a></span><span class="op">(</span><span class="va">javelin</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Chopra Etelatalo Katkavets   Mardare    Nadeem  Vadlejch </span></span>
<span><span class="co">##    0.0930    0.0482    0.0929    0.1173    0.1730    0.3206 </span></span>
<span><span class="co">##    Vesely     Weber </span></span>
<span><span class="co">##    0.1140    0.0409</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/dotchart.html" class="external-link">dotchart</a></span><span class="op">(</span><span class="va">mj</span>, pch <span class="op">=</span> <span class="fl">16</span>,xlab<span class="op">=</span><span class="st">"Estimated Bradley-Terry strength"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="hyper3_files/figure-html/unnamed-chunk-4-1.png" alt="Maximum  likelihood estimate for javelin throwers' Bradley-Terry strengths" width="672"><p class="caption">
Maximum likelihood estimate for javelin throwers’ Bradley-Terry
strengths
</p>
</div>
<p>From this, we see that Vadlejch has the highest estimated
Bradley-Terry strength, but further analysis with
<code><a href="../reference/tests.html">equalp.test()</a></code> reveals that there is no strong evidence in
the dataset to reject the hypothesis of equal competitive strength
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.26</mn></mrow><annotation encoding="application/x-tex">p=0.26</annotation></semantics></math>),
or that Vadlejch has a strength higher than the null value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mn>8</mn></mfrac><annotation encoding="application/x-tex">\frac{1}{8}</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">p=0.1</annotation></semantics></math>).</p>
<p>A particularly attractive feature of this analysis is that the
Bradley-Terry strengths have direct operational significance: If two
competitors, say Vadlejch and Vesely, were to throw a javelin, then we
would estimate the probability that Vadlejch would throw further than
Vesely at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mtext mathvariant="normal">Vad</mtext></msub><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mtext mathvariant="normal">Vad</mtext></msub><mo>+</mo><msub><mi>p</mi><mtext mathvariant="normal">Ves</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>≃</mo><mn>0.74</mn></mrow><annotation encoding="application/x-tex">\displaystyle p_{\mbox{Vad}}/\left(p_{\mbox{Vad}} +
p_{\mbox{Ves}}\right)\simeq 0.74</annotation></semantics></math>.
Indeed, from a training or selection perspective we might follow <span class="citation">(Hankin 2017)</span> and observe that log-contrasts
<span class="citation">(O’Hagan and Forster 2004)</span> appear to have
approximately Gaussian likelihood functions for observations of the type
considered here. Profile log-likelihood curves for log-contrasts are
easily produced by the package, below.</p>
<div class="figure">
<img src="hyper3_files/figure-html/unnamed-chunk-5-1.png" alt="Profile likelihood for log-contrast as per the text. Null indicated with a dotted line, and two-units-of-support limit indicated with horizontal lines; thus the null is not rejected" width="672"><p class="caption">
Profile likelihood for log-contrast as per the text. Null indicated with
a dotted line, and two-units-of-support limit indicated with horizontal
lines; thus the null is not rejected
</p>
</div>
<p>We see that the credible range for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mtext mathvariant="normal">Vad</mtext></msub><mi>/</mi><msub><mi>p</mi><mtext mathvariant="normal">Ves</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log\left(p_{\mbox{Vad}}/
p_{\mbox{Ves}}\right)</annotation></semantics></math> includes zero and
we have no strong evidence for these athletes having different
(Bradley-Terry) strengths.</p>
</div>
</div>
<div class="section level2">
<h2 id="formula-1-motor-racing-the-constructors-championship">Formula 1 motor racing: The Constructors’ Championship<a class="anchor" aria-label="anchor" href="#formula-1-motor-racing-the-constructors-championship"></a>
</h2>
<p>Formula 1 motor racing is an important and prestigious motor sport
<span class="citation">(Codling 2017, jenkins2010)</span>. In Formula 1
Grand Prix, the constructors’ championship takes place between
<em>manufacturers</em> of racing cars (compare the drivers’
championship, which is between drivers). In this analysis, the
constructor is the object of inference. Each constructor typically
fields two cars, each of which separately accumulates ranking-based
points at each venue. Here we use a generalized Plackett-Luce model to
assess the constructors’ performance. The following table, included in
the <code>hyper2</code> package as a dataset, shows rankings for the
first 9 venues of the 2021 season:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">constructor_2021_table</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##    Constructor BHR EMI POR ESP  MON AZE FRA STY</span></span>
<span><span class="co">## 1         Merc   1   2   1   1    7  12   2   2</span></span>
<span><span class="co">## 2         Merc   3 Ret   3   3  Ret  15   4   3</span></span>
<span><span class="co">## 3         RBRH   2   1   2   2    1   1   1   1</span></span>
<span><span class="co">## 4         RBRH   5  11   4   5    4  18   3   4</span></span>
<span><span class="co">## 5      Ferrari   6   4   6   4    2   4  11   6</span></span>
<span><span class="co">## 6      Ferrari   8   5  11   7 DNSP   8  16   7</span></span>
<span><span class="co">## 7           MM   4   3   5   6    3   5   5   5</span></span>
<span><span class="co">## 8           MM   7   6   9   8   12   9   6  13</span></span>
<span><span class="co">## 9           AR  13   9   7   9    9   6   8   9</span></span>
<span><span class="co">## 10          AR Ret  10   8  17   13 Ret  14  14</span></span>
<span><span class="co">## 11         ATH   9   7  10  10    6   3   7  10</span></span>
<span><span class="co">## 12         ATH  17  12  15 Ret   16   7  13 Ret</span></span>
<span><span class="co">## 13         AMM  10   8  13  11    5   2   9   8</span></span>
<span><span class="co">## 14         AMM  15  15  14  13    8 Ret  10  12</span></span>
<span><span class="co">## 15          WM  14 Ret  16  14   14  16  12  17</span></span>
<span><span class="co">## 16          WM  18 Ret  18  16   15  17  18 Ret</span></span>
<span><span class="co">## 17        ARRF  11  13  12  12   10  10  15  11</span></span>
<span><span class="co">## 18        ARRF  12  14 Ret  15   11  11  17  15</span></span>
<span><span class="co">## 19          HF  16  16  17  18   17  13  19  16</span></span>
<span><span class="co">## 20          HF Ret  17  19  19   18  14  20  18</span></span></code></pre>
<p>Above, we see that Mercedes (“<code>Merc</code>”) came first and
third at Bahrain (<code>BHR</code>); and came second and retired at
Emilia Romagna (<code>EMI</code>); full details of the notation and
conventions are given in the package at <code>constructor.Rd</code>. The
identity of the driver is viewed as inadmissible information and indeed
may change during a season. Alternatively, we may regard the driver and
the constructor as a joint entity, with the constructor’s ability to
attract and retain a skilled driver being part of the object of
inference. The associated generalized Plackett-Luce <code>hyper3</code>
object is easily constructed using package idiom, in this case
<code><a href="../reference/ordervec2supp3.html">ordertable2supp3()</a></code>, and we may use this to assess the
Plackett-Luce strengths of the constructors:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">const2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ordervec2supp3.html">ordertable2supp3</a></span><span class="op">(</span><span class="va">constructor_2020_table</span><span class="op">)</span></span>
<span><span class="va">const2021</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ordervec2supp3.html">ordertable2supp3</a></span><span class="op">(</span><span class="va">constructor_2021_table</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="fu"><a href="../reference/maxp.html">maxp</a></span><span class="op">(</span><span class="va">const2020</span><span class="op">)</span></span>
<span><span class="co">##    ARRF     ATH Ferrari      HF    Merc      MR       R </span></span>
<span><span class="co">## 0.04530 0.06807 0.06063 0.02623 0.37783 0.10026 0.09767 </span></span>
<span><span class="co">##    RBRH  RPBWTM      WM </span></span>
<span><span class="co">## 0.12072 0.08055 0.02273</span></span></code></pre>
<pre><code><span><span class="fu"><a href="../reference/maxp.html">maxp</a></span><span class="op">(</span><span class="va">const2021</span><span class="op">)</span></span>
<span><span class="co">##     AMM      AR    ARRF     ATH Ferrari      HF    Merc </span></span>
<span><span class="co">## 0.05942 0.07543 0.06238 0.05611 0.16939 0.02023 0.19395 </span></span>
<span><span class="co">##      MM    RBRH      WM </span></span>
<span><span class="co">## 0.14126 0.18334 0.03848</span></span></code></pre>
<p>Above, we see the strength of Mercedes falling from about 0.38 in
2020 to less than 0.20 in 2021 and it is natural to wonder whether this
can be ascribed to random variation. Observe that testing such a
hypothesis is complicated by the fact that constructors field multiple
cars, and also that constructors come and go, with two 2020 teams
dropping out between years and two joining. We may test this
statistically by defining a combined likelihood function for both years,
keeping track of the year:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">H</span> <span class="op">&lt;-</span> <span class="op">(</span></span>
<span>      <span class="fu"><a href="../reference/psubs.html">psubs</a></span><span class="op">(</span><span class="va">constructor_2020</span>, <span class="st">"Merc"</span>, <span class="st">"Merc2020"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="../reference/psubs.html">psubs</a></span><span class="op">(</span><span class="va">constructor_2021</span>, <span class="st">"Merc"</span>, <span class="st">"Merc2021"</span><span class="op">)</span></span>
<span>     <span class="op">)</span></span></code></pre></div>
<p>Above, we use generic function <code><a href="../reference/psubs.html">psubs()</a></code> to change the
name of Mercedes from <code>Merc</code> to <code>Merc2020</code> and
<code>Merc2021</code> respectively. Note the use of <code>+</code> to
represent addition of log-likelihoods, corresponding to the assumption
of conditional independence of results. The null would be simply that
the strengths of <code>Merc2020</code> and of <code>Merc2021</code> are
identical. Package idiom would be to use generic function
<code><a href="../reference/tests.html">samep.test()</a></code>:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/tests.html">samep.test</a></span><span class="op">(</span><span class="va">H</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Merc2020"</span>, <span class="st">"Merc2021"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Constrained support maximization</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  H</span></span>
<span><span class="co">## null hypothesis: Merc2020 = Merc2021</span></span>
<span><span class="co">## null estimate:</span></span>
<span><span class="co">##      AMM       AR     ARRF      ATH  Ferrari       HF </span></span>
<span><span class="co">##  0.04239  0.05413  0.04677  0.04374  0.07568  0.02323 </span></span>
<span><span class="co">## Merc2020 Merc2021       MM       MR        R     RBRH </span></span>
<span><span class="co">##  0.13903  0.13903  0.09016  0.07944  0.07475  0.10024 </span></span>
<span><span class="co">##   RPBWTM       WM </span></span>
<span><span class="co">##  0.06235  0.02905 </span></span>
<span><span class="co">## (argmax, constrained optimization)</span></span>
<span><span class="co">## Support for null:  -1189 + K</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## alternative hypothesis:  sum p_i=1 </span></span>
<span><span class="co">## alternative estimate:</span></span>
<span><span class="co">##      AMM       AR     ARRF      ATH  Ferrari       HF </span></span>
<span><span class="co">##  0.03766  0.04824  0.04333  0.04060  0.07036  0.02132 </span></span>
<span><span class="co">## Merc2020 Merc2021       MM       MR        R     RBRH </span></span>
<span><span class="co">##  0.23135  0.09216  0.07893  0.07973  0.07455  0.09322 </span></span>
<span><span class="co">##   RPBWTM       WM </span></span>
<span><span class="co">##  0.06177  0.02679 </span></span>
<span><span class="co">## (argmax, free optimization)</span></span>
<span><span class="co">## Support for alternative:  -1184 + K</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## degrees of freedom: 1</span></span>
<span><span class="co">## support difference = 4.722</span></span>
<span><span class="co">## p-value: 0.002119</span></span></code></pre>
<p>Above, we see strong evidence for a real decrease in the strength of
the Mercedes team from 2020 to 2021, with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.002</mn></mrow><annotation encoding="application/x-tex">p=0.002</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="conclusions-and-further-work">Conclusions and further work<a class="anchor" aria-label="anchor" href="#conclusions-and-further-work"></a>
</h2>
<p>Plackett-Luce likelihood functions for rank datasets have been
generalized to impose identity of Bradley-Terry strengths for certain
groups; the preferred interpretation is a running race in which the
competitors are split into equivalence classes of clones. Implementing
this in <code>R</code> is accomplished via a <code>C++</code> back-end
making use of the <code>STL</code> “map” class which offers efficiency
advantages, especially for large objects.</p>
<p>New likelihood functions for simple cases with three or four
competitors were presented, and extending to larger numbers furnishes a
generalization of the Mann-Whitney-Wilcoxon test that offers a specific
alternative (Bradley-Terry strength) with a clear operational
definition. Further generalizations allow the analysis of more than two
groups, here applied to Olympic javelin throw distances. Generalized
Plackett-Luce likelihood functions were used to assess the Grand Prix
constructors’ championship and a reasonable null. Specifically, the
hypothesis that the strength of the Mercedes team remained unchanged
between 2020 and 2021 was tested and rejected.</p>
<p>Draws are not considered in the present work but in principle may be
accommodated, either using likelihoods comprising sums of Plackett-Luce
probabilities <span class="citation">(Hankin 2017)</span>; or the
introduction of a reified draw entity <span class="citation">(Hankin
2010)</span>.</p>
<p>Further work might include a systematic comparison between
<code>hyper3</code> approach and the Mann-Whitney-Wilcoxon test,
including the characterisation of the power function of both tests. The
package could easily be extended to allow non-integer multiplicities,
which might prove useful in the context of reified Bradley Terry
techniques <span class="citation">(Hankin 2020)</span>.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-ahmad1996" class="csl-entry">
Ahmad, I. A. 1996. <span>“A Class of
<span>M</span>ann-Whitney-<span>W</span>ilcoxon Type Statistics.”</span>
<em>The American Statistician</em> 50 (4): 324–27.
</div>
<div id="ref-allison1994" class="csl-entry">
Allison, P. D., and N. A. Christakis. 1994. <span>“Logit Models for Sets
of Ranked Items.”</span> <em>Sociological Methodology</em> 24: 199–228.
</div>
<div id="ref-baker1994" class="csl-entry">
Baker, S. G. 1994. <span>“The Multinomial-<span>P</span>oisson
Transformation.”</span> <em>The Statistician</em> 43 (4): 495–504.
</div>
<div id="ref-codling2017" class="csl-entry">
Codling, S. 2017. <em>Speed Read <span>F1</span></em>. Motorbooks.
</div>
<div id="ref-rcore2023" class="csl-entry">
Core Team. 2023. <em>: A Language and Environment for Statistical
Computing</em>. Vienna, Austria: <span>Foundation</span> for
<span>Statistical</span> <span>Computing</span>. <a href="https://www.R-project.org/" class="external-link">https://www.R-project.org/</a>.
</div>
<div id="ref-edwards1972" class="csl-entry">
Edwards, A. W. F. 1972. <em>Likelihood</em>. John Hopkins University
Press.
</div>
<div id="ref-firth2005" class="csl-entry">
Firth, David. 2005. <span>“<span>B</span>radley-<span>T</span>erry
Models in <span>R</span>.”</span> <em>Journal of Statistical
Software</em> 12 (1).
</div>
<div id="ref-hankin2010" class="csl-entry">
Hankin, R. K. S. 2010. <span>“A Generalization of the Dirichlet
Distribution.”</span> <em>Journal of Statistical Software</em> 33 (11):
1–18. <a href="https://doi.org/10.18637/jss.v033.i11" class="external-link">https://doi.org/10.18637/jss.v033.i11</a>.
</div>
<div id="ref-hankin2017_rmd" class="csl-entry">
———. 2017. <span>“Partial Rank Data with the
<span><code>hyper2</code></span> Package: Likelihood Functions for
Generalized <span>B</span>radley-<span>T</span>erry Models.”</span>
<em>The R Journal</em> 9 (2): 429–39.
</div>
<div id="ref-hankin2020" class="csl-entry">
———. 2020. <span>“A Generalization of the
<span>B</span>radley-<span>T</span>erry Model for Draws in Chess with an
Application to Collusion.”</span> <em>Journal of Economic Behavior and
Organization</em> 180: 325–33.
</div>
<div id="ref-hankin2022" class="csl-entry">
———. 2022. <em>: Non-Ordered Vectors</em>. <a href="https://github.com/RobinHankin/disordR" class="external-link">https://github.com/RobinHankin/disordR</a>.
</div>
<div id="ref-hankin2024_hyper3" class="csl-entry">
———. 2024. <span>“Generalized <span>P</span>lackett-<span>L</span>uce
Likelihoods.”</span> <em>Journal of Statistical Software</em> 109 (8).
<a href="https://doi.org/10.18637/jss.v109.i08" class="external-link">https://doi.org/10.18637/jss.v109.i08</a>.
</div>
<div id="ref-hollander2013" class="csl-entry">
Hollander, M., D. A. Wolfe, and E. Chicken. 2013. <em>Nonparametric
Statistical Methods</em>. 3rd ed. John Wiley. https://doi.org/<a href="https://doi.org/10.1002/9781119196037" class="external-link">https://doi.org/10.1002/9781119196037</a>.
</div>
<div id="ref-hunter2004" class="csl-entry">
Hunter, D. R. 2004. <span>“<span>M</span><span>M</span> Algorithms for
Generalized <span>B</span>radley-<span>T</span>erry Models.”</span>
<em>The Annals of Statistics</em> 32 (1): 384–406.
</div>
<div id="ref-mann1947" class="csl-entry">
Mann, H. B., and D. R. Whitney. 1947. <span>“On a Test of Whether One of
Two Random Variables Is Stochastically Larger Than the Other.”</span>
<em>Ann. Math. Statist.</em> 18 (1): 50–60. https://doi.org/<a href="https://doi.org/10.1214/aoms/1177730491" class="external-link">https://doi.org/10.1214/aoms/1177730491</a>.
</div>
<div id="ref-maystre2022" class="csl-entry">
Maystre, L. 2022. <em>: Inference Algorithms for Models Based on
<span>L</span>uce’s Choice Axiom</em>. <a href="https://github.com/lucasmaystre/choix" class="external-link">https://github.com/lucasmaystre/choix</a>.
</div>
<div id="ref-mollica2014" class="csl-entry">
Mollica, C., and L. Tardella. 2014. <span>“Epitope Profiling via Mixture
Modeling of Ranked Data.”</span> <em>Statistics in Medicine</em> 33:
3738–58.
</div>
<div id="ref-ohagan2004" class="csl-entry">
O’Hagan, A., and J. Forster. 2004. <em>Kendall’s Advanced Theory of
Statistics, Volume 2<span>B</span>: <span>B</span>ayesian
Inference</em>. 2nd ed. John Wiley &amp; Sons. https://doi.org/<a href="https://doi.org/10.1111/j.1467-985x.2004.00347_15.x" class="external-link">https://doi.org/10.1111/j.1467-985x.2004.00347_15.x</a>.
</div>
<div id="ref-plackett1975" class="csl-entry">
Plackett, R. L. 1975. <span>“The Analysis of Permutations.”</span>
<em>Applied Statistics</em> 24: 193–202.
</div>
<div id="ref-turner2012" class="csl-entry">
Turner, H. L., and David Firth. 2012.
<span>“<span>B</span>radley-<span>T</span>erry Models in : The
Package.”</span> <em>Journal of Statistical Software</em> 48 (9): 1–21.
<a href="https://doi.org/10.18637/jss.v048.i09" class="external-link">https://doi.org/10.18637/jss.v048.i09</a>.
</div>
<div id="ref-turner2020" class="csl-entry">
Turner, H. L., Jacob van Etten, David Firth, and Ioannis Kosmidis. 2020.
<span>“Modelling Rankings in : The Package.”</span> <em>Computational
Statistics</em> 35: 1027–57. <a href="https://doi.org/10.1007/s00180-020-00959-3" class="external-link">https://doi.org/10.1007/s00180-020-00959-3</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Robin K. S. Hankin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
