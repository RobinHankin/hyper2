<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Public perception of climate change: the `icons` dataset in the `hyper2` package • hyper2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Public perception of climate change: the `icons` dataset in the `hyper2` package">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hyper2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/dirichlet.html">The `dirichlet()` function in the `hyper2` package</a>
    </li>
    <li>
      <a href="../articles/hyper3_creation.html">Creating `hyper3` objects in the `hyper2` package</a>
    </li>
    <li>
      <a href="../articles/hyper3.html">Generalized Plackett-Luce Likelihoods</a>
    </li>
    <li>
      <a href="../articles/icons.html">Public perception of climate change: the `icons` dataset in the `hyper2` package</a>
    </li>
    <li>
      <a href="../articles/ordertrans.html">The `ordertrans()` function in the `hyper2` package</a>
    </li>
    <li>
      <a href="../articles/zeropower.html">The zero-sum-power issue in the `hyper2` package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/RobinHankin/hyper2/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Public perception of climate change: the
<code>icons</code> dataset in the <code>hyper2</code> package</h1>
                        <h4 data-toc-skip class="author">Robin K. S.
Hankin</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RobinHankin/hyper2/blob/master/vignettes/icons.Rmd" class="external-link"><code>vignettes/icons.Rmd</code></a></small>
      <div class="hidden name"><code>icons.Rmd</code></div>

    </div>

    
    
<p><img src="../../../_temp/Library/hyper2/help/figures/hyper2.png" width="20%" style="float:right; padding:10px"></p>
<p>To cite the <code>hyper2</code> package in publications, please use
<span class="citation">Hankin (<a href="#ref-hankin2017_rmd">2017</a>)</span>. This short document
analyses the climate change dataset introduced by <span class="citation">O’Neill (<a href="#ref-oneill2008">2007</a>)</span> and
discussed in the <code>hyperdirichlet</code> R package <span class="citation">(<a href="#ref-hankin2010">Hankin 2010</a>)</span>, but
using the improved <code>hyper2</code> package instead. <span class="citation">O’Neill and Hulme (<a href="#ref-oneill2009">2009</a>)</span> observe that lay perception of
climate change is a complex and interesting process, and here we assess
the engagement of non-experts by the use of “icons” (this word is
standard in this context. An icon is a “representative symbol”) that
illustrate different impacts of climate change.</p>
<p>Here we analyse results of one experiment <span class="citation">(<a href="#ref-oneill2008">O’Neill 2007</a>)</span>, in which subjects were
presented with a set of icons of climate change and asked to identify
which of them they found most concerning. Six icons were used: PB [polar
bears, which face extinction through loss of ice floe hunting grounds],
NB [the Norfolk Broads, which flood due to intense rainfall events], L
[London flooding, as a result of sea level rise], THC [the thermo-haline
circulation, which may slow or stop as a result of anthropogenic
modification of the water cycle], OA [oceanic acidification as a result
of anthropogenic emissions of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">C</mi><msub><mi mathvariant="normal">O</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathrm
C}{\mathrm O}_2</annotation></semantics></math>], and WAIS [the West
Antarctic Ice Sheet, which is rapidly calving as a result of climate
change]. Methodological constraints dictated that each respondent could
be presented with a maximum of four icons. The R idiom below (dataset
<code>icons</code> in the package) shows the experimental results.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/RobinHankin/hyper2" class="external-link">"hyper2"</a></span>,quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="va">icons_table</span> <span class="co"># saves typing</span></span>
<span><span class="va">M</span></span></code></pre></div>
<pre><code><span><span class="co">##       NB  L PB THC OA WAIS</span></span>
<span><span class="co">##  [1,]  5  3 NA   4 NA    3</span></span>
<span><span class="co">##  [2,]  3 NA  5   8 NA    2</span></span>
<span><span class="co">##  [3,] NA  4  9   2 NA    1</span></span>
<span><span class="co">##  [4,] 10  3 NA   3  4   NA</span></span>
<span><span class="co">##  [5,]  4 NA  5   6  3   NA</span></span>
<span><span class="co">##  [6,] NA  4  3   1  3   NA</span></span>
<span><span class="co">##  [7,]  5  1 NA  NA  1    2</span></span>
<span><span class="co">##  [8,]  5 NA  1  NA  1    1</span></span>
<span><span class="co">##  [9,] NA  9  7  NA  2    0</span></span></code></pre>
<p>(M is called <code>icons_table</code> in the package). Each row of
<code>M</code> corresponds to a particular cue given to respondents. The
first row, for example, means that a total of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mo>+</mo><mn>3</mn><mo>+</mo><mn>4</mn><mo>+</mo><mn>3</mn><mo>=</mo><mn>15</mn></mrow><annotation encoding="application/x-tex">5+3+4+3=15</annotation></semantics></math>
people were shown icons NB, L, THC, WAIS [column names of the the non-NA
entries]; 5 people chose NB as most concerning, 3 chose L, and so on.
The dataset is more fully described in the package. The builtin
<code>icons</code> likelihood function in the <code>hyper2</code>
package may be created by using the <code><a href="../reference/matrix2supp.html">saffy()</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">icons</span></span></code></pre></div>
<pre><code><span><span class="co">## log(L^24 * (L + NB + OA + THC)^-20 * (L + NB + OA + WAIS)^-9 * (L + NB</span></span>
<span><span class="co">## + THC + WAIS)^-15 * (L + OA + PB + THC)^-11 * (L + OA + PB + WAIS)^-18</span></span>
<span><span class="co">## * (L + PB + THC + WAIS)^-16 * NB^32 * (NB + OA + PB + THC)^-18 * (NB +</span></span>
<span><span class="co">## OA + PB + WAIS)^-8 * (NB + PB + THC + WAIS)^-18 * OA^14 * PB^30 *</span></span>
<span><span class="co">## THC^24 * WAIS^9)</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">icons</span> <span class="op">==</span> <span class="fu"><a href="../reference/matrix2supp.html">saffy</a></span><span class="op">(</span><span class="va">icons_table</span><span class="op">)</span>  <span class="co"># should be TRUE</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>At this point, the <code>icons</code> object as created above is
mathematically identical to the <code>icons</code> object in the
<code>hyperdirichlet</code> package (and indeed the <code>hyper2</code>
package), but the terms might appear in a different order due to
<code>disordR</code> discipline.</p>
<div class="section level3">
<h3 id="analysis-of-the-icons-dataset">Analysis of the icons dataset<a class="anchor" aria-label="anchor" href="#analysis-of-the-icons-dataset"></a>
</h3>
<p>The first step is to find the maximum likelihood estimate for the
<code>icons</code> likelihood:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"digits"</span> <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">mic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/maxp.html">maxp</a></span><span class="op">(</span><span class="va">icons</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      NB       L      PB     THC      OA    WAIS </span></span>
<span><span class="co">## 0.25230 0.17364 0.22458 0.17011 0.11069 0.06867</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/dotchart.html" class="external-link">dotchart</a></span><span class="op">(</span><span class="va">mic</span>,pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span></code></pre></div>
<p><img src="icons_files/figure-html/estmaxlike-1.png" width="700"></p>
<p>We also need the log-likelihood at an unconstrained maximum:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loglik.html">loglik</a></span><span class="op">(</span><span class="fu"><a href="../reference/fillup.html">indep</a></span><span class="op">(</span><span class="va">mic</span><span class="op">)</span>,<span class="va">icons</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">L1</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -174.997435</span></span></code></pre>
<p>We see agreement to 4 decimal places with the value given in the
<code>hyperdirichlet</code> package. The next step is to assess a number
of hypotheses concerning the relative sizes of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_1</annotation></semantics></math>
through
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>6</mn></msub><annotation encoding="application/x-tex">p_6</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="hypothesis-testing-">Hypothesis testing.<a class="anchor" aria-label="anchor" href="#hypothesis-testing-"></a>
</h2>
<p>Below, I investigate a number of inequality hypotheses about
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>p</mi><mn>6</mn></msub></mrow><annotation encoding="application/x-tex">p_1,\ldots, p_6</annotation></semantics></math>.
The general analysis proceeds as follows; we can use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>p</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mi>/</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">H_0\colon p_1=1/6</annotation></semantics></math>
as an example but the method applies to any observation. I consider the
general case first, then modifications for one-sided hypotheses.</p>
<ul>
<li>We have an observation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝒪</mi><annotation encoding="application/x-tex">{\mathcal O}</annotation></semantics></math>
and wish to quantify the strength of evidence to support this.</li>
<li>Translate our observation into a hypothesis phrased in terms as a
restriction on parameter space.</li>
<li>State a null hypothesis and alternative. For example, we might have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>p</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mi>/</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">H_0\colon p_1=1/6</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>A</mi></msub><mo>:</mo><msub><mi>p</mi><mn>1</mn></msub><mo>≠</mo><mn>1</mn><mi>/</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">H_A\colon p_1\neq 1/6</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>A</mi></msub><annotation encoding="application/x-tex">H_A</annotation></semantics></math>
is the complement of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>.
We sometimes write
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>A</mi></msub><mo>:</mo><mo>∑</mo><msub><mi>p</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">H_A\colon\sum p_i=1</annotation></semantics></math>,
ignoring the (measure zero)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>.</li>
<li>We then attempt to reject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>
and to do this we perform two likelihood maximizations: one
unconstrained, corresponding to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>A</mi></msub><annotation encoding="application/x-tex">H_A</annotation></semantics></math>,
and one constrained, corresponding to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>.</li>
<li>We calculate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ℒ</mi><msub><mi>H</mi><mn>0</mn></msub></msub><mo>:=</mo><msub><mo>argmax</mo><mrow><mi>p</mi><mo>∈</mo><msub><mi>H</mi><mn>0</mn></msub></mrow></msub><mi>ℒ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">{\mathcal L}_{H_0} :=\operatorname{argmax}_{p\in
H_0}{\mathcal L}(p)</annotation></semantics></math> and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ℒ</mi><msub><mi>H</mi><mi>A</mi></msub></msub><mo>:=</mo><msub><mo>argmax</mo><mrow><mi>p</mi><mo>∈</mo><msub><mi>H</mi><mi>A</mi></msub></mrow></msub><mi>ℒ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">{\mathcal L}_{H_A} :=
\operatorname{argmax}_{p\in H_A}{\mathcal L}(p)</annotation></semantics></math>
and observe that, in general,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝒪</mi><annotation encoding="application/x-tex">{\mathcal O}</annotation></semantics></math>
implies the strict inequality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ℒ</mi><msub><mi>H</mi><mi>A</mi></msub></msub><mo>&gt;</mo><msub><mi>ℒ</mi><msub><mi>H</mi><mn>0</mn></msub></msub></mrow><annotation encoding="application/x-tex">{\mathcal L}_{H_A} &gt; {\mathcal L}_{H_0}</annotation></semantics></math>.</li>
<li>Calculate the likelihood ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><msub><mi>ℒ</mi><msub><mi>H</mi><mi>A</mi></msub></msub><mi>/</mi><msub><mi>ℒ</mi><msub><mi>H</mi><mn>0</mn></msub></msub><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">R={\mathcal L}_{H_A}/{\mathcal L}_{H_0}&gt;1</annotation></semantics></math>
or equivalently the <em>support</em> for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Λ</mi><mo>=</mo><mo>log</mo><mi>R</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\Lambda = \log R&gt;0</annotation></semantics></math>.</li>
<li>We may either use Edwards’s criterion of two units of support per
degree of freedom, or Wilks’s theorem:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>→</mo><mn>2</mn><mi>Λ</mi><mo>∼</mo><msubsup><mi>χ</mi><mi>d</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">H_0\longrightarrow 2\Lambda\sim\chi^2_d</annotation></semantics></math>.
If we are considering inequality hypotheses, we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">d=1</annotation></semantics></math>.</li>
<li>If the criterion is met we may reject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>
and infer that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>A</mi></msub><annotation encoding="application/x-tex">H_A</annotation></semantics></math>
is the case.</li>
</ul>
<p>As another example, consider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>p</mi><mn>1</mn></msub><mo>=</mo><msub><mi>p</mi><mn>2</mn></msub><mo>=</mo><msub><mi>p</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">H_0\colon p_1=p_2=p_3</annotation></semantics></math>.
The vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐩</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">{</mo><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>p</mi><mn>6</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><mo>∑</mo><msub><mi>p</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">{\mathbf p}\in \left\{\left.\left(p_1,\ldots,p_6\right)\right| \sum
p_i=1\right\}</annotation></semantics></math> is a point in a
5-dimensional manifold, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>
asserts that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐩</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">{</mo><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><msub><mi>p</mi><mn>4</mn></msub><mo>,</mo><msub><mi>p</mi><mn>5</mn></msub><mo>,</mo><msub><mi>p</mi><mn>6</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><mn>3</mn><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><msub><mi>p</mi><mn>4</mn></msub><mo>+</mo><msub><mi>p</mi><mn>5</mn></msub><mo>+</mo><msub><mi>p</mi><mn>6</mn></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">{\mathbf p}\in
\left\{\left.\left(p_1,p_1,p_1,p_4,p_5,p_6\right)\right|
3p_1+p_4+p_5+p_6=1\right\}</annotation></semantics></math>, that is, a
3-dimensional manifold. The null imposes a loss of two degrees of
freedom.</p>
<p>The logic above operates for one-sided tests. We might observe that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><msub><mi>p</mi><mn>1</mn></msub><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{p_1}</annotation></semantics></math>
is the largest and wish to test a null of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><mn>1</mn><mi>/</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">p_1\leqslant
1/6</annotation></semantics></math> against an alternative of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>&gt;</mo><mn>1</mn><mi>/</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">p_1&gt;1/6</annotation></semantics></math>.
Note that the one-sided p-value and likelihood ratio statistic are the
same as the two-sided values.</p>
<p>Below I will rework some of the hypotheses tested in the
hyperdirichlet package, with consistent labelling of null and
alternative hypotheses, and renumbering</p>
<div class="section level3">
<h3 id="equality-of-strengths">Equality of strengths<a class="anchor" aria-label="anchor" href="#equality-of-strengths"></a>
</h3>
<p>The most straightforward null would be the hypothesis of player
equality, specifically:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>E</mi></msub><mo>:</mo><msub><mi>p</mi><mn>1</mn></msub><mo>=</mo><msub><mi>p</mi><mn>2</mn></msub><mo>=</mo><mi>⋯</mi><mo>=</mo><msub><mi>p</mi><mi>n</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
H_E\colon p_1=p_2=\cdots=p_n=\frac{1}{n}.
</annotation></semantics></math></p>
<p>(“E” for equal). This was not carried out in <span class="citation">Hankin (<a href="#ref-hankin2010">2010</a>)</span>,
because I had not thought of it. Testing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>E</mi></msub><annotation encoding="application/x-tex">H_E</annotation></semantics></math>
is implemented in the package as <code>test.equalp()</code>. Note that
because
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>E</mi></msub><annotation encoding="application/x-tex">H_E</annotation></semantics></math>
is a point hypothesis we would have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math>
degrees of freedom (because
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>
has
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math>
df).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tests.html">equalp.test</a></span><span class="op">(</span><span class="va">icons</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Constrained support maximization</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  icons</span></span>
<span><span class="co">## null hypothesis: NB = L = PB = THC = OA = WAIS</span></span>
<span><span class="co">## null estimate:</span></span>
<span><span class="co">##          NB           L          PB         THC          OA        WAIS </span></span>
<span><span class="co">## 0.166666667 0.166666667 0.166666667 0.166666667 0.166666667 0.166666667 </span></span>
<span><span class="co">## (argmax, constrained optimization)</span></span>
<span><span class="co">## Support for null:  -184.37715 + K</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## alternative hypothesis:  sum p_i=1 </span></span>
<span><span class="co">## alternative estimate:</span></span>
<span><span class="co">##           NB            L           PB          THC           OA         WAIS </span></span>
<span><span class="co">## 0.2523041150 0.1736443259 0.2245818764 0.1701128100 0.1106860420 0.0686708306 </span></span>
<span><span class="co">## (argmax, free optimization)</span></span>
<span><span class="co">## Support for alternative:  -174.997435 + K</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## degrees of freedom: 5</span></span>
<span><span class="co">## support difference = 9.37971546</span></span>
<span><span class="co">## p-value: 0.00213083779</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="hypothesis-1-p_1-16">Hypothesis 1:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mi>/</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">p_1 = 1/6</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#hypothesis-1-p_1-16"></a>
</h3>
<p>Following the analysis in <span class="citation">Hankin (<a href="#ref-hankin2010">2010</a>)</span>, and restated above, we first
observe that NB [the Norfolk Broads] is the icon with the largest
estimated probability with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><msub><mi>p</mi><mn>1</mn></msub><mo accent="true">̂</mo></mover><mo>≃</mo><mn>0.25</mn></mrow><annotation encoding="application/x-tex">\hat{p_1}\simeq 0.25</annotation></semantics></math>
(O’Neill gives a number of theoretical reasons to expect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_1</annotation></semantics></math>
to be large). This would suggest that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_1</annotation></semantics></math>
is in fact large, in some sense, and here I show how to assess this
statement statistically. Consider the hypothesis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>p</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mi>/</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">H_0\colon p_1=1/6</annotation></semantics></math>,
and as per the protocol above we will try to reject it.</p>
<p>To that end, we perform a constrained optimization, with (active)
constraint that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><mn>1</mn><mi>/</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">p_1\leqslant 1/6</annotation></semantics></math>
(note that the inequality constraint allows us to use fast
<code><a href="../reference/maxp.html">maxp()</a></code>, which has access to derivatives). We note the
support at the evaluate and then compare this support with the support
at the unconstrained evaluate; if the difference in support is large
then this constitutes strong evidence for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>A</mi></msub><annotation encoding="application/x-tex">H_A</annotation></semantics></math>
and then would conclude that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>&gt;</mo><mn>1</mn><mi>/</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">p_1 &gt; 1/6</annotation></semantics></math>.
In package idiom, the optimization is implemented by the
<code><a href="../reference/tests.html">specificp.test()</a></code> suite of functions; these work by imposing
additional constraints to the <code><a href="../reference/maxp.html">maxp()</a></code> function via the
<code>fcm</code> and <code>fcv</code> arguments. Using the defaults we
have:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tests.html">specificp.test</a></span><span class="op">(</span><span class="va">icons</span>,<span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Constrained support maximization</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  H</span></span>
<span><span class="co">## null hypothesis: sum p_i=1, p_1 = 0.166666667</span></span>
<span><span class="co">## null estimate:</span></span>
<span><span class="co">##           NB            L           PB          THC           OA         WAIS </span></span>
<span><span class="co">## 0.1666666514 0.1935760159 0.2520057446 0.1848196512 0.1248364824 0.0780954545 </span></span>
<span><span class="co">## (argmax, constrained optimization)</span></span>
<span><span class="co">## Support for null:  -177.614346 + K</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## alternative hypothesis:  sum p_i=1 </span></span>
<span><span class="co">## alternative estimate:</span></span>
<span><span class="co">##           NB            L           PB          THC           OA         WAIS </span></span>
<span><span class="co">## 0.2523041150 0.1736443259 0.2245818764 0.1701128100 0.1106860420 0.0686708306 </span></span>
<span><span class="co">## (argmax, free optimization)</span></span>
<span><span class="co">## Support for alternative:  -174.997435 + K</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## degrees of freedom: 1</span></span>
<span><span class="co">## support difference = 2.61691171</span></span>
<span><span class="co">## p-value: 0.0221517868 (two sided)</span></span></code></pre>
<p>which tests a null of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><mfrac><mn>1</mn><mn>6</mn></mfrac></mrow><annotation encoding="application/x-tex">p_1\leqslant\frac{1}{6}</annotation></semantics></math>;
see how the evaluate under the null is on the boundary and we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><msub><mi>p</mi><mn>1</mn></msub><mo accent="true">̂</mo></mover><mo>=</mo><mfrac><mn>1</mn><mn>6</mn></mfrac></mrow><annotation encoding="application/x-tex">\hat{p_1}=\frac{1}{6}</annotation></semantics></math>.
Compare the support of 2.607 with 2.608181 from the
<code>hyperdirichlet</code> package. This exceeds Edwards’s
two-units-of-support criterion; the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
is obtained by applying Wilks’s theorem on the asymptotic distribution
of 2.</p>
<p>Both these criteria indicate that we may reject that hypothesis that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><mn>1</mn><mi>/</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">p_1\leqslant 1/6</annotation></semantics></math>
and thereby infer
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>&gt;</mo><mfrac><mn>1</mn><mn>6</mn></mfrac></mrow><annotation encoding="application/x-tex">p_1&gt;\frac{1}{6}</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="hypothesis-2-p_1geqslantmaxleftp_2ldotsp_6right">Hypothesis 2:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>≥</mo><mo>max</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>p</mi><mn>6</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_1\geqslant\max\left(p_2,\ldots,p_6\right)</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#hypothesis-2-p_1geqslantmaxleftp_2ldotsp_6right"></a>
</h3>
<p>We observe that NB (the Norfolk Broads) has large strength, and
hypothesise that it is in fact stronger than any other icon. This is
another constrained likelihood maximization, although this one is not
possible with convex constraints. In the language of the generic
procedure given above, we would have</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∪</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>p</mi><mn>3</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∪</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>p</mi><mn>4</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∪</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>p</mi><mn>5</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∪</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>p</mi><mn>6</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
H_0\colon 
(p_1\leqslant p_2)\cup
(p_1\leqslant p_3)\cup
(p_1\leqslant p_4)\cup
(p_1\leqslant p_5)\cup
(p_1\leqslant p_6)
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><msub><mi>H</mi><mn>0</mn></msub><mo accent="true">¯</mo></mover><mo>:</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>&gt;</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∩</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>&gt;</mo><msub><mi>p</mi><mn>3</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∩</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>&gt;</mo><msub><mi>p</mi><mn>4</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∩</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>&gt;</mo><msub><mi>p</mi><mn>5</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∩</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>&gt;</mo><msub><mi>p</mi><mn>6</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\overline{H_0}\colon 
(p_1 &gt; p_2)\cap
(p_1 &gt; p_3)\cap
(p_1 &gt; p_4)\cap
(p_1 &gt; p_5)\cap
(p_1 &gt; p_6)
</annotation></semantics></math></p>
<p>(although note that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>
has nonzero measure). In words,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>
states that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_1</annotation></semantics></math>
is smaller than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>2</mn></msub><annotation encoding="application/x-tex">p_2</annotation></semantics></math>,
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_1</annotation></semantics></math>
is smaller than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>3</mn></msub><annotation encoding="application/x-tex">p_3</annotation></semantics></math>,
etc; while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><msub><mi>H</mi><mn>0</mn></msub><mo accent="true">¯</mo></mover><annotation encoding="application/x-tex">\overline{H_0}</annotation></semantics></math>
states that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_1</annotation></semantics></math>
is larger than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>2</mn></msub><annotation encoding="application/x-tex">p_2</annotation></semantics></math>,
and is larger than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>3</mn></msub><annotation encoding="application/x-tex">p_3</annotation></semantics></math>,
and so on. Considering the evaluate, we see that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ℒ</mi><msub><mi>H</mi><mn>0</mn></msub></msub><mo>&lt;</mo><msub><mi>ℒ</mi><mover><msub><mi>H</mi><mn>0</mn></msub><mo accent="true">¯</mo></mover></msub></mrow><annotation encoding="application/x-tex">{\mathcal L}_{H_0} &lt; {\mathcal L}_{\overline{H_0}}</annotation></semantics></math>,
so optimizing over
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><msub><mi>H</mi><mn>0</mn></msub><mo accent="true">¯</mo></mover><annotation encoding="application/x-tex">\overline{H_0}</annotation></semantics></math>
is equivalent to unconstrained optimization [of course, the intrinsic
constraints
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>≥</mo><mn>0</mn><mo>,</mo><mo>∑</mo><msub><mi>p</mi><mi>i</mi></msub><mo>≤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p_i\geqslant 0,
\sum p_i\leqslant 1</annotation></semantics></math> have to be
respected]. Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><msub><mi>H</mi><mn>0</mn></msub><mo accent="true">¯</mo></mover><annotation encoding="application/x-tex">\overline{H_0}</annotation></semantics></math>
is regions of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>p</mi><mn>6</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(p_1,\ldots,p_6)</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_1</annotation></semantics></math>
being greater than <em>at least one</em> of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>p</mi><mn>6</mn></msub></mrow><annotation encoding="application/x-tex">p_2,\ldots,p_6</annotation></semantics></math>.
The union of convex sets is not necessarily convex (e.g. a two-way Venn
diagram). As far as I can see, the only way to do it is to perform a
sequence of five constrained optimizations:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>p</mi><mn>2</mn></msub><mo>,</mo><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>p</mi><mn>3</mn></msub><mo>,</mo><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>p</mi><mn>4</mn></msub><mo>,</mo><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>p</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">p_1\leqslant p_2, p_1\leqslant p_3, p_1\leqslant p_4,
p_1\leqslant p_5</annotation></semantics></math>. The fillup constraint
would be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>p</mi><mn>6</mn></msub><mo>→</mo><mn>2</mn><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><msub><mi>p</mi><mn>2</mn></msub><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>p</mi><mn>5</mn></msub><mo>≤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p_1\leqslant
p_6\longrightarrow 2p_1+p_2+\cdots +p_5\leqslant 1</annotation></semantics></math>.
We then choose the largest likelihood from the five.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Ul</span>,<span class="va">Cl</span>,<span class="va">startp</span>,<span class="va">give</span><span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">small</span> <span class="op">&lt;-</span> <span class="fl">1e-4</span>  <span class="co">#  ensure start at an interior point</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">startp</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="va">startp</span> <span class="op">&lt;-</span> <span class="va">small</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">}</span>           </span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/maxp.html">maxp</a></span><span class="op">(</span><span class="va">icons</span>, startp<span class="op">=</span><span class="va">small</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">5</span><span class="op">)</span>, give<span class="op">=</span><span class="cn">TRUE</span>, fcm<span class="op">=</span><span class="va">Ul</span>,fcv<span class="op">=</span><span class="va">Cl</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">give</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">value</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">p2max</span> <span class="op">&lt;-</span> <span class="fu">o</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>  <span class="co"># p1 &lt;= p2</span></span>
<span><span class="va">p3max</span> <span class="op">&lt;-</span> <span class="fu">o</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>  <span class="co"># p1 &lt;= p3</span></span>
<span><span class="va">p4max</span> <span class="op">&lt;-</span> <span class="fu">o</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>  <span class="co"># p1 &lt;= p4</span></span>
<span><span class="va">p5max</span> <span class="op">&lt;-</span> <span class="fu">o</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>  <span class="co"># p1 &lt;= p5</span></span>
<span><span class="va">p6max</span> <span class="op">&lt;-</span> <span class="fu">o</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>  <span class="co"># p1 &lt;= p6 (fillup)</span></span></code></pre></div>
<p>(the final line is different because
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>6</mn></msub><annotation encoding="application/x-tex">p_6</annotation></semantics></math>
is the fillup value).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">likes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p2max</span>,<span class="va">p3max</span>,<span class="va">p4max</span>,<span class="va">p5max</span>,<span class="va">p6max</span><span class="op">)</span></span>
<span><span class="va">likes</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -175.810521 -175.081858 -175.983441 -178.204173 -181.515387</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ml</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">likes</span><span class="op">)</span> </span>
<span><span class="va">ml</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -175.081858</span></span></code></pre>
<p>Thus the first element of <code>likes</code> corresponds to the
maximum likelihood, constrained so that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_1\leqslant p_2</annotation></semantics></math>;
the second element corresponds to the constraint that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>p</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">p_1\leqslant p_3</annotation></semantics></math>,
and so on. The largest likelihood is the easiest constraint to break, in
this case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>p</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">p_1\leqslant p_3</annotation></semantics></math>:
this makes sense because
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>3</mn></msub><annotation encoding="application/x-tex">p_3</annotation></semantics></math>
has the second highest MLE after
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_1</annotation></semantics></math>.
The extra likelihood is given by</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L1</span><span class="op">-</span><span class="va">ml</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.0844236585</span></span></code></pre>
<p>(the <code>hyperdirichlet</code> package gives 0.0853 here, a
surprisingly small discrepancy given the difficulties of optimizing over
a nonconvex region). We conclude that there is no evidence for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>≥</mo><mo>max</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>p</mi><mn>6</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_1\geqslant\max\left(p_2,\ldots,p_6\right)</annotation></semantics></math>.</p>
<p>It’s worth looking at the evaluate too:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Ul</span>,<span class="va">Cl</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">jj</span> <span class="op">&lt;-</span><span class="fu">o</span><span class="op">(</span><span class="va">Ul</span>,<span class="va">Cl</span>,give<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">jj</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">jj</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,<span class="va">jj</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p1"</span>,<span class="st">"p2"</span>,<span class="st">"p3"</span>,<span class="st">"p4"</span>,<span class="st">"p5"</span>,<span class="st">"p6"</span>,<span class="st">"support"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span><span class="fu">o2</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>,  <span class="co"># p1 &lt;= p2</span></span>
<span><span class="fu">o2</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>,  <span class="co"># p1 &lt;= p3</span></span>
<span><span class="fu">o2</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>,  <span class="co"># p1 &lt;= p4</span></span>
<span><span class="fu">o2</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>,  <span class="co"># p1 &lt;= p5</span></span>
<span><span class="fu">o2</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>   <span class="co"># p1 &lt;= p6</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##               p1          p2          p3          p4          p5           p6</span></span>
<span><span class="co">## [1,] 0.211674267 0.211674268 0.226222108 0.169452254 0.111434270 0.0695428329</span></span>
<span><span class="co">## [2,] 0.238552641 0.174097331 0.238552998 0.169739010 0.110517185 0.0685408341</span></span>
<span><span class="co">## [3,] 0.209075905 0.175046706 0.228380262 0.209075907 0.110003635 0.0684175840</span></span>
<span><span class="co">## [4,] 0.181049944 0.176566992 0.228589945 0.165076513 0.181049945 0.0676666608</span></span>
<span><span class="co">## [5,] 0.159212367 0.174456695 0.234412699 0.168868084 0.103837779 0.1592123762</span></span>
<span><span class="co">##          support</span></span>
<span><span class="co">## [1,] -175.810521</span></span>
<span><span class="co">## [2,] -175.081858</span></span>
<span><span class="co">## [3,] -175.983441</span></span>
<span><span class="co">## [4,] -178.204173</span></span>
<span><span class="co">## [5,] -181.515387</span></span></code></pre>
<p>In the above, the evaluate is the first five columns
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>6</mn></msub><annotation encoding="application/x-tex">p_6</annotation></semantics></math>
being the fillup) and the final column is the log-likelihood at the
evaluate. See how the constraint is active in each line:
<code>M[1,] == M[1:5,2:6]</code>. Also note that the largest
log-likelihood is the second row: if we were to violate any of the
constraints, it would be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>p</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">p_1&lt;p_3</annotation></semantics></math>,
consistent with the fact that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>3</mn></msub><annotation encoding="application/x-tex">p_3</annotation></semantics></math>
(polar bears) has the second highest strength, after
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_1</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="low-frequency-responses">Low frequency responses<a class="anchor" aria-label="anchor" href="#low-frequency-responses"></a>
</h3>
<p>The next hypothesis follows from the observed smallness of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><msub><mi>p</mi><mn>5</mn></msub><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{p_5}</annotation></semantics></math>
(ocean acidification) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><msub><mi>p</mi><mn>6</mn></msub><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{p_6}</annotation></semantics></math>
(West Antarctic Ice Sheet) at 0.111 and 0.069 respectively. These two
strengths correspond to “distant” concerns and O’Neill had reason to
consider their sum (which she argued would be small). Thus we specify
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>p</mi><mn>5</mn></msub><mo>+</mo><msub><mi>p</mi><mn>6</mn></msub><mo>≤</mo><mfrac><mn>1</mn><mn>3</mn></mfrac></mrow><annotation encoding="application/x-tex">H_0\colon
p_5+p_6\leqslant \frac{1}{3}</annotation></semantics></math>.</p>
<p>The optimizing constraint of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>5</mn></msub><mo>+</mo><msub><mi>p</mi><mn>6</mn></msub><mo>≥</mo><mfrac><mn>1</mn><mn>3</mn></mfrac></mrow><annotation encoding="application/x-tex">p_5+p_6\geqslant\frac{1}{3}</annotation></semantics></math>
translates to an operational constraint of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><msub><mi>p</mi><mn>1</mn></msub><mo>−</mo><msub><mi>p</mi><mn>2</mn></msub><mo>−</mo><msub><mi>p</mi><mn>3</mn></msub><mo>−</mo><msub><mi>p</mi><mn>4</mn></msub><mo>≥</mo><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac></mrow><annotation encoding="application/x-tex">-p_1-p_2-p_3-p_4\geqslant-\frac{2}{3}</annotation></semantics></math>
(because
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>5</mn></msub><mo>+</mo><msub><mi>p</mi><mn>6</mn></msub><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mn>1</mn></msub><mo>−</mo><msub><mi>p</mi><mn>2</mn></msub><mo>−</mo><msub><mi>p</mi><mn>3</mn></msub><mo>−</mo><msub><mi>p</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">p_5+p_6=1-p_1-p_2-p_3-p_4</annotation></semantics></math>):</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jj</span> <span class="op">&lt;-</span> <span class="fu">o</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span> , <span class="op">-</span><span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, give<span class="op">=</span><span class="cn">TRUE</span>,start<span class="op">=</span><span class="fu"><a href="../reference/fillup.html">indep</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">/</span><span class="fl">21</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">value</span></span>
<span><span class="va">jj</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -182.21078</span></span></code></pre>
<p>then the extra support is</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L1</span><span class="op">-</span><span class="va">jj</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 7.21334577</span></span></code></pre>
<p>(compare 7.711396 in <code>hyperdirichlet</code>, not sure why the
discrepancy is so large).</p>
</div>
<div class="section level3">
<h3 id="final-example">Final example<a class="anchor" aria-label="anchor" href="#final-example"></a>
</h3>
<p>The final example is motivated by the fact that both the distant
icons
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>5</mn></msub><annotation encoding="application/x-tex">p_5</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>6</mn></msub><annotation encoding="application/x-tex">p_6</annotation></semantics></math>
had lower strength than any of the local icons
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>p</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">p_1,\ldots, p_4</annotation></semantics></math>.
Thus we would have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mo>max</mo><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>p</mi><mn>5</mn></msub><mo>,</mo><msub><mi>p</mi><mn>6</mn></msub><mo stretchy="true" form="postfix">}</mo></mrow><mo>≥</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><msub><mi>p</mi><mn>2</mn></msub><mo>,</mo><msub><mi>p</mi><mn>3</mn></msub><mo>,</mo><msub><mi>p</mi><mn>4</mn></msub><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">H_0\colon\max\left\{p_5,p_6\right\}\geqslant\min\left\{p_1,p_2,p_3,p_4\right\}</annotation></semantics></math>.
This means the null optimization is constrained so that <em>at least
one</em> of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>p</mi><mn>5</mn></msub><mo>,</mo><msub><mi>p</mi><mn>6</mn></msub><mo stretchy="true" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\left\{p_5,p_6\right\}</annotation></semantics></math>
exceeds <em>at least one</em> of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><msub><mi>p</mi><mn>2</mn></msub><mo>,</mo><msub><mi>p</mi><mn>3</mn></msub><mo>,</mo><msub><mi>p</mi><mn>4</mn></msub><mo stretchy="true" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\left\{p_1,p_2,p_3,p_4\right\}</annotation></semantics></math>.
So we have the union of the various possibilities:</p>
<p><span class="math display">$$\begin{equation}\label{eq:Habar}H_0=
\overline{H_A}\colon
\bigcup_{j\in\left\{5,6\right\}\atop k\in\left\{1,2,3,4\right\}}
\left\{\left(p_1,p_2,p_3,p_4,p_5,p_6\right)\left|\sum p_i=1,
p_j\geqslant p_k\right.\right\}
\end{equation}$$</span></p>
<p>The fillup value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>6</mn></msub><annotation encoding="application/x-tex">p_6</annotation></semantics></math>
behaves differently in this context and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>6</mn></msub><mo>≥</mo><msub><mi>p</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">p_6\geqslant p_2</annotation></semantics></math>,
say, translates to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><msub><mi>p</mi><mn>1</mn></msub><mo>−</mo><mn>2</mn><msub><mi>p</mi><mn>2</mn></msub><mo>−</mo><msub><mi>p</mi><mn>3</mn></msub><mo>−</mo><msub><mi>p</mi><mn>4</mn></msub><mo>−</mo><msub><mi>p</mi><mn>5</mn></msub><mo>≥</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-p_1-2p_2-p_3-p_4-p_5\geqslant
-1</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">small</span> <span class="op">&lt;-</span> <span class="fl">1e-4</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fillup.html">indep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">small</span>,<span class="va">small</span>,<span class="va">small</span>,<span class="va">small</span>,<span class="fl">0.5</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">small</span>,<span class="fl">0.5</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">small</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">jj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>   <span class="fu">o</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">0</span>,start<span class="op">=</span><span class="va">start</span><span class="op">)</span>,  <span class="co"># p1 &gt;= p5</span></span>
<span>   <span class="fu">o</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,<span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">0</span>,start<span class="op">=</span><span class="va">start</span><span class="op">)</span>,  <span class="co"># p2 &gt;= p5</span></span>
<span>   <span class="fu">o</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>, <span class="fl">0</span>,<span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">0</span>,start<span class="op">=</span><span class="va">start</span><span class="op">)</span>,  <span class="co"># p3 &gt;= p5</span></span>
<span>   <span class="fu">o</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,<span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">0</span>,start<span class="op">=</span><span class="va">start</span><span class="op">)</span>,  <span class="co"># p4 &gt;= p5</span></span>
<span></span>
<span>   <span class="fu">o</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="op">-</span><span class="fl">1</span>,start<span class="op">=</span><span class="va">start</span><span class="op">)</span>,  <span class="co"># p1 &gt;= p6</span></span>
<span>   <span class="fu">o</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">2</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="op">-</span><span class="fl">1</span>,start<span class="op">=</span><span class="va">start</span><span class="op">)</span>,  <span class="co"># p2 &gt;= p6</span></span>
<span>   <span class="fu">o</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">2</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="op">-</span><span class="fl">1</span>,start<span class="op">=</span><span class="va">start</span><span class="op">)</span>,  <span class="co"># p3 &gt;= p6</span></span>
<span>   <span class="fu">o</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">2</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>,<span class="op">-</span><span class="fl">1</span>,start<span class="op">=</span><span class="va">start</span><span class="op">)</span>   <span class="co"># p4 &gt;= p6</span></span>
<span>   <span class="op">)</span></span>
<span><span class="va">jj</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -178.204173 -175.894803 -177.318942 -175.747872 -181.515387 -177.978365</span></span>
<span><span class="co">## [7] -180.406280 -177.753717</span></span></code></pre>
<p>Above, the elements of vector <code>jj</code> are the maximum
likelihoods for each of the separate components of the parameter space
allowed under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>.
Note that these components are not disjoint. So the maximum likelhood
for the whole of allowable parameters under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>
would be the maximum of these maxima:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">jj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -175.747872</span></span></code></pre>
<p>This corresponds to the fourth component of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>,
viz
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>4</mn></msub><mo>=</mo><msub><mi>p</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">p_4=p_5</annotation></semantics></math>.
The extra support is thus</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">jj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.750437512</span></span></code></pre>
<p>(compare <code>hyperdirichlet</code> which gives 3.16, not sure why
the difference although if pressed I would point to <code>hyper2</code>
using multiple walkers in its optimization [defaulting to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">n=10</annotation></semantics></math>]
). We should look at the maximum value:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">o</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,<span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">0</span>,give<span class="op">=</span><span class="cn">TRUE</span>,start<span class="op">=</span><span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $par</span></span>
<span><span class="co">## [1] 0.250298786 0.173616322 0.224279186 0.141760611 0.141760626</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $value</span></span>
<span><span class="co">## [1] -175.747872</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $counts</span></span>
<span><span class="co">## function gradient </span></span>
<span><span class="co">##      551       86 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $convergence</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $message</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $outer.iterations</span></span>
<span><span class="co">## [1] 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $barrier.value</span></span>
<span><span class="co">## [1] 0.000172310891</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $likes</span></span>
<span><span class="co">## [1] -175.747872</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $evaluate</span></span>
<span><span class="co">##           NB            L           PB          THC           OA         WAIS </span></span>
<span><span class="co">## 0.2502987861 0.1736163215 0.2242791861 0.1417606108 0.1417606257 0.0682844698</span></span></code></pre>
<p>So the evaluate is at the boundary, for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>4</mn></msub><mo>=</mo><msub><mi>p</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">p_4=p_5</annotation></semantics></math>;
<code>THC</code> and <code>OA</code> have the same Bradley-Terry
strength. The small amount of extra support given by allowing an
unconstrained optimization would suggest that there is no strong
evidence for the contention investigated, viz “both the distant icons
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>5</mn></msub><annotation encoding="application/x-tex">p_5</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>6</mn></msub><annotation encoding="application/x-tex">p_6</annotation></semantics></math>
have lower strength than any of the local icons
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>p</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">p_1,\ldots, p_4</annotation></semantics></math>”.</p>
</div>
<div class="section level3">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-hankin2010" class="csl-entry">
Hankin, R. K. S. 2010. <span>“A Generalization of the Dirichlet
Distribution.”</span> <em>Journal of Statistical Software</em> 33 (11):
1–18. <a href="https://doi.org/10.18637/jss.v033.i11" class="external-link">https://doi.org/10.18637/jss.v033.i11</a>.
</div>
<div id="ref-hankin2017_rmd" class="csl-entry">
———. 2017. <span>“Partial Rank Data with the
<span><code>hyper2</code></span> Package: Likelihood Functions for
Generalized <span>B</span>radley-<span>T</span>erry Models.”</span>
<em>The R Journal</em> 9 (2): 429–39.
</div>
<div id="ref-oneill2008" class="csl-entry">
O’Neill, S. J. 2007. <span>“An Iconic Approach to Representing Climate
Change.”</span> PhD thesis, School of Environmental Science, University
of East Anglia.
</div>
<div id="ref-oneill2009" class="csl-entry">
O’Neill, S. J., and M. Hulme. 2009. <span>“An Iconic Approach for
Representing Climate Change.”</span> <em>Global Environmental
Change</em> 19: 402–10.
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Robin K. S. Hankin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
