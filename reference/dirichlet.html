<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Dirichlet distribution and generalizations — dirichlet • hyper2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Dirichlet distribution and generalizations — dirichlet"><meta property="og:description" content="The Dirichlet distribution in likelihood (for p) form, including the
generalized Dirichlet distribution due to Connor and Mosimann"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hyper2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.2-2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/dirichlet.html">The `dirichlet()` function in the `hyper2` package</a>
    </li>
    <li>
      <a href="../articles/hyper3_creation.html">Creating `hyper3` objects in the `hyper2` package</a>
    </li>
    <li>
      <a href="../articles/hyper3.html">Generalized Plackett-Luce Likelihoods</a>
    </li>
    <li>
      <a href="../articles/icons.html">Public perception of climate change: the `icons` dataset in the `hyper2` package</a>
    </li>
    <li>
      <a href="../articles/ordertrans.html">The `ordertrans()` function in the `hyper2` package</a>
    </li>
    <li>
      <a href="../articles/zeropower.html">The zero-sum-power issue in the `hyper2` package</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/RobinHankin/hyper2/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Dirichlet distribution and generalizations</h1>

    <div class="hidden name"><code>dirichlet.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The Dirichlet distribution in likelihood (for p) form, including the
generalized Dirichlet distribution due to Connor and Mosimann</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dirichlet</span><span class="op">(</span><span class="va">powers</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span><span class="fu">dirichlet3</span><span class="op">(</span><span class="va">powers</span>, lambda<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">GD</span><span class="op">(</span><span class="va">alpha</span>, <span class="va">beta</span>, beta0<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu">GD_wong</span><span class="op">(</span><span class="va">alpha</span>, <span class="va">beta</span><span class="op">)</span></span>
<span><span class="fu">rdirichlet</span><span class="op">(</span><span class="va">n</span>,<span class="va">H</span><span class="op">)</span></span>
<span><span class="fu">is.dirichlet</span><span class="op">(</span><span class="va">H</span><span class="op">)</span></span>
<span><span class="fu">rp_unif</span><span class="op">(</span><span class="va">n</span>,<span class="va">H</span><span class="op">)</span></span>
<span><span class="fu">multinom</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-powers-x">powers,x<a class="anchor" aria-label="anchor" href="#arg-powers-x"></a></dt>
<dd><p>In functions <code>dirichlet()</code> and <code>multinom()</code>,
    a (named) vector of powers</p></dd>

  <dt id="arg-alpha-beta">alpha,beta<a class="anchor" aria-label="anchor" href="#arg-alpha-beta"></a></dt>
<dd><p>A vector of parameters for the Dirichlet or
    generalized Dirichlet distribution</p></dd>

  <dt id="arg-beta-">beta0<a class="anchor" aria-label="anchor" href="#arg-beta-"></a></dt>
<dd><p>In function <code>GD()</code>, an arbitrary parameter</p></dd>

  <dt id="arg-h">H<a class="anchor" aria-label="anchor" href="#arg-h"></a></dt>
<dd><p>Object of class <code>hyper2</code></p></dd>

  <dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Vector of weights in <code>dirichlet3()</code></p></dd>

  <dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Number of observations</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>These functions are really convenience functions.</p>
<p>Function <code>rdirichlet()</code> returns random samples drawn from a
  Dirichlet distribution using the gamma distribution.  If second
  argument <code>H</code> is a <code>hyper2</code> object, it is tested [with
  <code>is.dirichlet()</code>] for being a Dirichlet distribution.  If so,
  samples from it are returned.  If not, (e.g. <code>icons</code>), an error
  is given.  If <code>H</code> is not a <code>hyper2</code> object, it is
  interpreted as a (possibly named) vector of parameters
  \(\alpha\) [<strong>not</strong> a vector of powers].</p>
<p>Function <code>rp_unif()</code> returns uniformly distributed vectors,
  effectively using <code>H*0</code>; but note that this uses Dirichlet
  sampling which is much faster and better than the Metropolis-Hastings
  functionality documented at <code>rp.Rd</code>.</p>
<p>Functions <code>GD()</code> and <code>GD_wong()</code> return a likelihood
  function corresponding to the Generalized Dirichlet distribution as
  presented by Connor and Mosimann, and Wong, respectively.  In
  <code>GD_wong()</code>, <code>alpha</code> and <code>beta</code> must be named vectors;
  the names of <code>alpha</code> give the names of
  \(x_1,\ldots,x_k\) and the last element of <code>beta</code>
  gives the name of \(x_{k+1}\).</p>
<p>Function <code>dirichlet3()</code> returns a <code>hyper3</code> object with
  weights <code>lambda</code>.  If <code>lambda</code> is length less than that of
  <code>powers</code>, it is padded with <code>1</code>s [so default <code>NULL</code>
  corresponds to unit weights, that is, a <code>hyper2</code> object].  A
  use-case is given in <code>inst/rock_paper_scissors_monster.Rmd</code>.</p>
<p>Experimental function <code>multinom()</code> also takes a named vector and
  interprets it in almost the same way as <code>dirichlet()</code>, but it
  allows for repeated names.  It is interpreted as the support function
  for multinomial trials.  If <code>x</code> is a named vector with no
  repeats, <code>dirichlet(x) == multinom(x)</code>.  But <code>multinom()</code>
  uses <a href="https://CRAN.R-project.org/package=frab" class="external-link"><span class="pkg">frab</span></a> formalism to deal with multiple entries with the
  same name, which are summed.  This is the Right Way (tm) to do this.
  Negative numbers, having no natural interpretation in this context,
  are not allowed.  The numbers do not need to be integers.  One
  use-case is given in the examples (which should be faster than looping
  over the named vector and accumulating a <code>hyper2</code> object, element
  by element; but I have no timings on this as yet).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p></p><ul><li><p>R. J. Connor and J. E. Mosimann 1969.  “Concepts of
    independence for proportions with a generalization of the Dirichlet
    distribution”.  <em>Journal of the American Statistical
    Association</em>, 64:194–206</p></li>
<li><p>T.-T. Wong 1998. “Generalized Dirichlet distribution in
    Bayesian Analysis”.  <em>Applied Mathematics and Computation</em>,
    97:165–181</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Robin K. S. Hankin</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>A dirichlet distribution can have a term with zero power.  But
  this poses problems for <code>hyper2</code> objects as zero power brackets
  are dropped.</p>
<p>Function <code>dirichlet3()</code> is a replacement for now removed function
  <code>pair3()</code>.</p>
<p>Function <code>rdirichlet()</code> commits a very mild (but necessary in the
  absence of a working <code>dismat</code> package) violation of <code>disordR</code>
  discipline, as the columns of the returned matrix have the same order
  as <code>pnames(H)</code></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="hyper2.html">hyper2</a></code>,<code><a href="rp.html">rp</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu">dirichlet</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">1</span>,b<span class="op">=</span><span class="fl">2</span>,c<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu">dirichlet</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>c<span class="op">=</span><span class="fl">3</span>,d<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x1</span><span class="op">+</span><span class="va">x2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log( a * (a + b + c)^-6 * b^2 * c^6 * (c + d)^-7 * d^4)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">multinom</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">2</span>,a<span class="op">=</span><span class="fl">3</span>,b<span class="op">=</span><span class="fl">3</span>,x<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>  <span class="co"># NB repeated 'x'</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(a^3 * (a + b + x)^-9 * b^3 * x^3)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">40</span>,<span class="fl">2.2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,<span class="fl">40</span>,replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">multinom</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(a^21 * (a + b + c + d)^-102 * b^26 * c^27 * d^28)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">H</span> <span class="op">&lt;-</span> <span class="fu">dirichlet</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">1</span>,b<span class="op">=</span><span class="fl">2</span>,c<span class="op">=</span><span class="fl">3</span>,d<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">rdirichlet</span><span class="op">(</span><span class="fl">10</span>,<span class="va">H</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                a         b          c         d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.01489053 0.2773005 0.17545514 0.5323539</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.16490358 0.4473492 0.21954889 0.1681984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.10789406 0.5322661 0.08322359 0.2766163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.16966098 0.1607731 0.24824807 0.4213179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.19018396 0.2876375 0.13460494 0.3875736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.10645204 0.4885826 0.23210971 0.1728557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.06030589 0.3329259 0.21613456 0.3906336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.14609874 0.1888472 0.25023030 0.4148238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.07240817 0.4974437 0.08988788 0.3402603</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.24799704 0.3797639 0.25643394 0.1158052</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="fu">rdirichlet</span><span class="op">(</span><span class="fl">1e4</span>,<span class="va">H</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         a         b         c         d </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1443673 0.2119955 0.2860204 0.3576168 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">dirichlet3</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>fish<span class="op">=</span><span class="fl">3</span>,chips<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,lambda<span class="op">=</span><span class="fl">1.8</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log( (chips=1)^2 * (chips=1, fish=1.8)^-5 * (fish=1.8)^3)</span>
<span class="r-in"><span><span class="fu">dirichlet3</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">6</span>,y<span class="op">=</span><span class="fl">5</span>,z<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log( (x=1)^6 * (x=1, y=2, z=3)^-13 * (y=2)^5 * (z=3)^2)</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Robin K. S. Hankin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

